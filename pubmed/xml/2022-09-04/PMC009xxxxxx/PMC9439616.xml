<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="es" article-type="research-article"><?properties open_access?><?properties manuscript?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-journal-id">9918400285706676</journal-id><journal-id journal-id-type="pubmed-jr-id">51616</journal-id><journal-id journal-id-type="nlm-ta">Rev Iberoam Autom Informa Ind</journal-id><journal-id journal-id-type="iso-abbrev">Rev Iberoam Autom Informa Ind</journal-id><journal-title-group><journal-title>Revista iberoamericana de automatica e informatica industrial</journal-title></journal-title-group><issn pub-type="ppub">1697-7912</issn><issn pub-type="epub">1697-7920</issn></journal-meta><article-meta><article-id pub-id-type="pmc">PMC9439616</article-id><article-id pub-id-type="doi">10.4995/riai.2022.16798</article-id><article-id pub-id-type="manuscript">NIHMS1804923</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Un esquema de decisiones para intervenciones adaptativas comportamentales de actividad f&#x000ed;sica basado en control predictivo por modelo h&#x000ed;brido: ilustraci&#x000f3;n con <italic toggle="yes">Just Walk</italic></article-title><trans-title-group xml:lang="en"><trans-title>A decision framework for an adaptive behavioral intervention for physical activity using hybrid model predictive control: illustration with <italic toggle="yes">Just Walk</italic></trans-title></trans-title-group></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cevallos</surname><given-names>Daniel</given-names></name><xref rid="A1" ref-type="aff">a</xref></contrib><contrib contrib-type="author"><name><surname>Mart&#x000ed;n</surname><given-names>C&#x000e9;sar A.</given-names></name><xref rid="A1" ref-type="aff">a</xref></contrib><contrib contrib-type="author"><name><surname>Mistiri</surname><given-names>Mohamed El</given-names></name><xref rid="A2" ref-type="aff">b</xref></contrib><contrib contrib-type="author"><name><surname>Rivera</surname><given-names>Daniel E.</given-names></name><xref rid="A2" ref-type="aff">b</xref><xref rid="CR1" ref-type="corresp">*</xref></contrib><contrib contrib-type="author"><name><surname>Hekler</surname><given-names>Eric</given-names></name><xref rid="A3" ref-type="aff">c</xref></contrib></contrib-group><aff id="A1"><label>a</label>Escuela Superior Polit&#x000e9;cnica del Litoral, ESPOL, Facultad de Ingenier&#x000ed;a en Electricidad y Computaci&#x000f3;n, Campus Gustavo Galindo Km 30.5 V&#x000ed;a Perimetral, P. O. Box 09-01-5863, Guayaquil, Ecuador</aff><aff id="A2"><label>b</label>School for the Engineering of Matter, Transport, and Energy, Arizona State University, Tempe, Arizona 85287-6106, EEUU</aff><aff id="A3"><label>c</label>Herbert Wertheim School of Public Health and Human Longevity Science, University of California at San Diego, La Jolla, California 91222, EEUU</aff><author-notes><corresp id="CR1"><label>*</label>Autor para correspondencia: <email>daniel.rivera@asu.edu</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>18</day><month>5</month><year>2022</year></pub-date><pub-date pub-type="ppub"><day>29</day><month>6</month><year>2022</year></pub-date><pub-date pub-type="epub"><day>27</day><month>4</month><year>2022</year></pub-date><pub-date pub-type="pmc-release"><day>02</day><month>9</month><year>2022</year></pub-date><volume>19</volume><issue>3</issue><fpage>297</fpage><lpage>308</lpage><permissions><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncsalicense">https://creativecommons.org/licenses/by-nc-sa/4.0/</ali:license_ref><license-p>Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</license-p></license></permissions><abstract id="ABS1"><title>Resumen</title><p id="P1">La inactividad f&#x000ed;sica es uno de los principales factores que contribuyen a la morbilidad y la mortalidad mundial. Muchas intervenciones comportamentales de actividad f&#x000ed;sica en la actualidad han mostrado un &#x000e9;xito limitado al abordar el problema desde una perspectiva a largo plazo que incluye el mantenimiento. Este art&#x000ed;culo propone el dise&#x000f1;o de un algoritmo de decisi&#x000f3;n para una intervenci&#x000f3;n adaptativa de salud m&#x000f3;vil e inal&#x000e1;mbrica (mHealth) que se basa en conceptos de ingenier&#x000ed;a de control. El proceso de dise&#x000f1;o se basa en un modelo din&#x000e1;mico que representa el comportamiento basada en la Teor&#x000ed;a Cognitiva Social (TCS), con una formulaci&#x000f3;n de toma de decisiones basada en control predictivo por modelo h&#x000ed;brido (HMPC por sus siglas en ingl&#x000e9;s). Las caracter&#x000ed;sticas discretas y l&#x000f3;gicas del HMPC coinciden con la naturaleza categ&#x000f3;rica de los componentes de la intervenci&#x000f3;n y las decisiones l&#x000f3;gicas que son propias de una intervenci&#x000f3;n para la actividad f&#x000ed;sica. La intervenci&#x000f3;n incorpora un modo de reconfiguraci&#x000f3;n del controlador en l&#x000ed;nea que aplica cambios en los pesos de penalizaci&#x000f3;n para lograr la transici&#x000f3;n entre las etapas de entrenamiento de iniciaci&#x000f3;n comportamental y mantenimiento. Se ilustra el desempe&#x000f1;o del controlador utilizando un modelo ARX estimado de datos de un participante representativo de <italic toggle="yes">Just Walk</italic>, una intervenci&#x000f3;n de actividad f&#x000ed;sica dise&#x000f1;ada usando principios de sistemas de control.</p></abstract><trans-abstract id="ABS2" xml:lang="en"><p id="P2">Physical inactivity is a major contributor to morbidity and mortality worldwide. Many current physical activity behavioral interventions have shown limited success addressing the problem from a long-term perspective that includes maintenance. This paper proposes the design of a decision algorithm for a mobile and wireless health (mHealth) adaptive intervention that is based on control engineering concepts. The design process relies on a behavioral dynamical model based on Social Cognitive Theory (SCT), with a controller formulation based on hybrid model predictive control (HMPC) being used to implement the decision scheme. The discrete and logical features of HMPC coincide naturally with the categorical nature of the intervention components and the logical decisions that are particular to an intervention for physical activity. The intervention incorporates an online controller reconfiguration mode that applies changes in the penalty weights to accomplish the transition between the behavioral initiation and maintenance training stages. Controller performance is illustrated using an ARX model estimated from system identification data of a representative participant for <italic toggle="yes">Just Walk</italic>, a physical activity intervention designed on the basis of control systems principles.</p></trans-abstract><kwd-group><title>Palabras clave:</title><kwd>Control predictivo h&#x000ed;brido</kwd><kwd>control autom&#x000e1;tico de variables fisiol&#x000f3;gicas y cl&#x000ed;nicas</kwd><kwd>identificaci&#x000f3;n de sistemas</kwd></kwd-group><kwd-group xml:lang="en"><kwd>Model predictive control of hybrid systems</kwd><kwd>control of physiological and clinical variables</kwd><kwd>system identification</kwd></kwd-group></article-meta></front><body><sec id="S1"><label>1.</label><title>Introducci&#x000f3;n</title><p id="P3">Una variedad de condiciones de salud graves, entre ellas el c&#x000e1;ncer de mama y de colon, la obesidad, la diabetes y las enfermedades cardiovasculares, est&#x000e1;n relacionadas con la inactividad f&#x000ed;sica (<xref rid="R27" ref-type="bibr">McGinnis et al., 2002</xref>). Para el c&#x000e1;ncer de mama en particular, las estimaciones sugieren que el riesgo de desarrollar esta enfermedad se puede reducir entre un 20 y un 30 % realizando entre 30 y 60 minutos de actividad f&#x000ed;sica (AF) de intensidad moderada al d&#x000ed;a (<xref rid="R5" ref-type="bibr">Clague and Bernstein, 2012</xref>). Las tecnolog&#x000ed;as de salud m&#x000f3;vil (mHealth) son adecuadas para ofrecer intervenciones rentables, escalables y adaptables para promover la actividad f&#x000ed;sica; los tel&#x000e9;fonos inteligentes juegan un papel importante porque pueden detectar las actividades y el contexto de los usuarios, y permiten la implementaci&#x000f3;n de aplicaciones avanzadas. Sin embargo, la mayor&#x000ed;a de las intervenciones de AF de mHealth desarrolladas por investigadores solo se han evaluado en pruebas piloto a corto plazo (por ejemplo, de 4 semanas a 6 meses) con efectos moderados (<xref rid="R31" ref-type="bibr">Payne et al., 2015</xref>) y requieren una evaluaci&#x000f3;n de su efectividad en condiciones reales.</p><p id="P4">Se ha propuesto el uso de principios de ingenier&#x000ed;a de sistemas de control (<xref rid="R30" ref-type="bibr">Navarro-Barrientos et al., 2011</xref>; <xref rid="R36" ref-type="bibr">Timms et al., 2014a</xref>; <xref rid="R6" ref-type="bibr">Deshpande et al., 2014</xref>) para abordar problemas de salud comportamental. La teor&#x000ed;a cognitiva social (TCS; <xref rid="R2" ref-type="bibr">Bandura (1986)</xref>) es una ilustraci&#x000f3;n bien fundamentada y aceptada de los elementos causales del comportamiento humano; b&#x000e1;sicamente describe c&#x000f3;mo interact&#x000fa;an los diferentes componentes para influir en el comportamiento y otros constructos, y se ha utilizado como base para muchas intervenciones comportamentales. En trabajos anteriores, se desarroll&#x000f3; un modelo din&#x000e1;mico de la TCS orientado al control (<xref rid="R26" ref-type="bibr">Mart&#x000ed;n et al., 2020</xref>). Utilizando una intervenci&#x000f3;n de AF de lazo abierto como referencia, se ha dise&#x000f1;ado un conjunto de experimentos de identificaci&#x000f3;n del sistema a nivel idiogr&#x000e1;fico (es decir, un solo sujeto) para buscar y refinar los par&#x000e1;metros del modelo y con fines de validaci&#x000f3;n (<xref rid="R22" ref-type="bibr">Mart&#x000ed;n et al., 2015a</xref>,<xref rid="R24" ref-type="bibr">c</xref>). Bas&#x000e1;ndose en estas ideas, se ha desarrollado una intervenci&#x000f3;n piloto de mHealth llamada &#x0201c;<italic toggle="yes">Just Walk</italic>&#x0201d; (<xref rid="R12" ref-type="bibr">Hekler, 2015</xref>) con an&#x000e1;lisis presentados en various art&#x000ed;culos (<xref rid="R10" ref-type="bibr">Freigoun et al., 2017</xref>; <xref rid="R17" ref-type="bibr">Korinek et al., 2018</xref>; <xref rid="R32" ref-type="bibr">Phatak et al., 2018</xref>). Esta intervenci&#x000f3;n proporciona pasos diarios &#x0201c;ambiciosos pero factibles&#x0218a; refuerzos para lograr los objetivos.</p><p id="P5">El prop&#x000f3;sito de este trabajo es desarrollar un algoritmo de decisi&#x000f3;n para una intervenci&#x000f3;n adaptativa de mHealth para promover la actividad f&#x000ed;sica (medida en t&#x000e9;rminos de pasos diarios) entre adultos sedentarios. Para lograr resultados exitosos de la intervenci&#x000f3;n a largo plazo, se incluyen dos fases: una etapa de entrenamiento de iniciaci&#x000f3;n comportamental donde los individuos son conducidos progresivamente a un estado saludable a trav&#x000e9;s de la introducci&#x000f3;n de recompensas y objetivos de pasos diarios, y una fase de mantenimiento donde las recompensas son gradualmente disminuidas en base a la capacidad mejorada de las personas para continuar participando con el comportamiento requerido, que es impulsado por un proceso interno de autorregulaci&#x000f3;n humana. El marco de decisi&#x000f3;n para la intervenci&#x000f3;n se basa en una formulaci&#x000f3;n de control predictivo de modelo h&#x000ed;brido (HMPC; <xref rid="R29" ref-type="bibr">Nandola and Rivera (2013)</xref>). Soluciones basadas en HMPC se han considerado anteriormente en entornos de salud comportamental (<xref rid="R6" ref-type="bibr">Deshpande et al., 2014</xref>; <xref rid="R37" ref-type="bibr">Timms et al., 2014b</xref>; <xref rid="R7" ref-type="bibr">Dong et al., 2014</xref>). Una formulaci&#x000f3;n inicial de HMPC para actividad f&#x000ed;sica basada en un modelo hipot&#x000e9;tico de TCS se encuentra en <xref rid="R25" ref-type="bibr">Mart&#x000ed;n et al. (2016)</xref>. La pol&#x000ed;tica de decisiones basada en HMPC que se presenta aqu&#x000ed; se enmarca en conceptos de din&#x000e1;mica l&#x000f3;gica mixta (DLM) para describir conjuntos discretos de objetivos y recompensas como componentes de la intervenci&#x000f3;n. Tambi&#x000e9;n se utiliza para representar el proceso l&#x000f3;gico de otorgar recompensas solo si se alcanzan los objetivos diarios. La formulaci&#x000f3;n emplea una modalidad de tres grados de libertad para ajustar de forma independiente las especificaciones requeridas. Se propone la reconfiguraci&#x000f3;n del controlador mediante la manipulaci&#x000f3;n de ponderaciones de penalizaci&#x000f3;n para abordar la transici&#x000f3;n entre las fases de inicio y mantenimiento. Se presentan los resultados de una simulaci&#x000f3;n que considera un escenario hipot&#x000e9;tico para una intervenci&#x000f3;n de AF; todo esto con el prop&#x000f3;sito de ilustrar los beneficios del enfoque propuesto al abordar la din&#x000e1;mica h&#x000ed;brida, el seguimiento del punto de ajuste, el rechazo de perturbaciones y la transici&#x000f3;n entre las dos etapas de la intervenci&#x000f3;n.</p><p id="P6">Este art&#x000ed;culo est&#x000e1; organizado de la siguiente forma: la secci&#x000f3;n 2 describe el modelo TCS y los diferentes componentes de la intervenci&#x000f3;n. La secci&#x000f3;n 3 da un resumen del dise&#x000f1;o de la intervenci&#x000f3;n <italic toggle="yes">Just Walk</italic>, y del uso de m&#x000e9;todos de la identificaci&#x000f3;n de sistemas para estimar un modelo din&#x000e1;mico usando datos de un participante representativo. La secci&#x000f3;n 4 presenta la formulaci&#x000f3;n de la intervenci&#x000f3;n basada en HMPC correspondiente al modelo estimado en la secci&#x000f3;n 3, lo cual incluye las restricciones l&#x000f3;gicas y discretas y la reconfiguraci&#x000f3;n del controlador. La secci&#x000f3;n 5 presenta un estudio de simulaci&#x000f3;n para probar el desempe&#x000f1;o del controlador en presencia de perturbaciones. Finalmente, la secci&#x000f3;n 6 ofrece un resumen de nuestras conclusiones y describe el trabajo futuro.</p></sec><sec id="S2"><label>2.</label><title>Intervenci&#x000f3;n comportamental adaptativa basada en TCS.</title><p id="P7">El objetivo principal de la intervenci&#x000f3;n propuesta es promover la actividad f&#x000ed;sica entre personas sedentarias, con el objetivo espec&#x000ed;fico de lograr 10,000 pasos por d&#x000ed;a (o +3,000 pasos por d&#x000ed;a m&#x000e1;s que la l&#x000ed;nea de base) en promedio semanal. El objetivo se alcanzar&#x000e1; mediante el dise&#x000f1;o y la implementaci&#x000f3;n de una intervenci&#x000f3;n eficaz para el cambio de comportamiento que se basa en la Teor&#x000ed;a Cognitiva Social (TCS; <xref rid="R2" ref-type="bibr">Bandura (1986)</xref>). La TCS es una teor&#x000ed;a psicol&#x000f3;gica bien reconocida en la que el comportamiento se describe utilizando una perspectiva de agencia humana en la que los individuos reflexionan, autorregulan y se organizan de forma proactiva. Algunos de los constructos m&#x000e1;s relevantes son:
<list list-type="bullet" id="L2"><list-item><p id="P8"><italic toggle="yes">Comportamiento</italic>, el comportamiento real de inter&#x000e9;s, por ejemplo, los pasos realizados diariamente.</p></list-item><list-item><p id="P9"><italic toggle="yes">Auto-eficacia</italic>, la capacidad autopercibida para realizar una determinada conducta.</p></list-item><list-item><p id="P10"><italic toggle="yes">Resultados de comportamiento</italic>, obtenido como resultado de la participaci&#x000f3;n en el comportamiento, por ejemplo, p&#x000e9;rdida de peso.</p></list-item><list-item><p id="P11"><italic toggle="yes">Est&#x000ed;mulos internos y externos</italic>, desencadenantes para participar en un comportamiento.</p></list-item><list-item><p id="P12"><italic toggle="yes">Contexto ambiental</italic>, en el que ocurre el comportamiento.</p></list-item></list></p><p id="P13">En el trabajo de <xref rid="R26" ref-type="bibr">Mart&#x000ed;n et al. (2020)</xref>, se presenta un modelo din&#x000e1;mico de TCS apoy&#x000e1;ndose en una analog&#x000ed;a de fluidos que describe los constructos y sus interrelaciones descritas por la teor&#x000ed;a. La <xref rid="F1" ref-type="fig">Figura 1</xref> describe una versi&#x000f3;n simplificada del modelo TCS que representa una articulaci&#x000f3;n &#x0201c;conductista&#x0201d;de los determinantes del comportamiento (<xref rid="R9" ref-type="bibr">Ferster, 1970</xref>), donde cada <italic toggle="yes">&#x003be;</italic><sub><italic toggle="yes">i</italic></sub> representa una entrada, <italic toggle="yes">&#x003b7;</italic><sub><italic toggle="yes">i</italic></sub> es una salida, <italic toggle="yes">&#x003b3;</italic><sub><italic toggle="yes">ij</italic></sub> y <italic toggle="yes">&#x003b2;</italic><sub><italic toggle="yes">ij</italic></sub> representan la interrelaci&#x000f3;n entre los diferentes constructos, <italic toggle="yes">&#x003b6;</italic><sub><italic toggle="yes">i</italic></sub> es una perturbaci&#x000f3;n externa, y <italic toggle="yes">&#x003b8;</italic><sub><italic toggle="yes">i</italic></sub> representa tiempos de retardo.</p><p id="P14">Suponiendo una din&#x000e1;mica de primer orden, el modelo se describe mediante el siguiente conjunto de ecuaciones diferenciales:
<disp-formula id="FD1">
<label>(1)</label>
<mml:math id="M1" display="block"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mn>29</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>25</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>14</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b6;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD2">
<label>(2)</label>
<mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mn>311</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b6;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD3">
<label>(3)</label>
<mml:math id="M3" display="block"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>42</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>43</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>46</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>17</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>45</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>19</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b6;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD4">
<label>(4)</label>
<mml:math id="M4" display="block"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mn>57</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>15</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mn>510</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mn>54</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b6;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD5">
<label>(5)</label>
<mml:math id="M5" display="block"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mn>68</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b6;</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula></p><p id="P500">La intervenci&#x000f3;n adaptativa comportamental propuesta se describe en la <xref rid="F2" ref-type="fig">Figura 2</xref>, donde la cantidad de pasos diarios realizados se mide mediante la se&#x000f1;al <italic toggle="yes">y</italic><sub>4</sub>. Se basa en la entrega sistem&#x000e1;tica de los siguientes componentes, basados en el desempe&#x000f1;o real de las personas:
<list list-type="bullet" id="L4"><list-item><p id="P15"><italic toggle="yes">Metas diarias u</italic><sub>8</sub>, para establecer de forma cuantitativa el comportamiento deseado, e.g., 10,000 pasos por d&#x000ed;a.</p></list-item><list-item><p id="P16"><italic toggle="yes">Puntos esperados u</italic><sub>9</sub>, los puntos de recompensa diarios anunciados que se otorgar&#x000e1;n a las personas si logran el objetivo diario.</p></list-item><list-item><p id="P17"><italic toggle="yes">Puntos otorgados u</italic><sub>10</sub>, administrado todos los d&#x000ed;as si las personas alcanzan la meta establecida; esta caracter&#x000ed;stica est&#x000e1; representada por el bloque &#x0201c;If/Then&#x0201d;. Los puntos se pueden canjear posteriormente por recompensas tangibles, por ejemplo, tarjetas de regalo.</p></list-item><list-item><p id="P18"><italic toggle="yes">Logro de metas &#x003be;</italic><sub>11</sub> = <italic toggle="yes">u</italic><sub>11</sub> = <italic toggle="yes">y</italic><sub>4</sub> &#x02212; <italic toggle="yes">u</italic><sub>8</sub> = <italic toggle="yes">y</italic><sub>7</sub>, es una se&#x000f1;al que representa la diferencia entre el comportamiento realizado y las metas diarias. Esta se&#x000f1;al sirve como entrada para el inventario de <italic toggle="yes">auto-eficacia</italic>, pero tambi&#x000e9;n podr&#x000ed;a ser &#x000fa;til como salida para determinar el impacto de la intervenci&#x000f3;n.</p></list-item></list></p><p id="P19">En <xref rid="R25" ref-type="bibr">Mart&#x000ed;n et al. (2016)</xref>, la intervenci&#x000f3;n se eval&#x000fa;a utilizando un modelo TCS mejorado con autoregulaci&#x000f3;n individualizada a trav&#x000e9;s de se&#x000f1;ales internas para representar una meta de pasos diarios (por ejemplo, 10,000 pasos) que la persona percibe como alcanzable. En el trabajo de <xref rid="R3" ref-type="bibr">Carver and Scheier (1998)</xref> se presenta un mecanismo de autorregulaci&#x000f3;n del comportamiento humano modelado como un proceso de retroalimentaci&#x000f3;n, en el cual individuos realizan ajustes autocorrectores para mantenerse encaminados hacia una meta definida. El control de modelo interno (IMC; <xref rid="R28" ref-type="bibr">Morari and Zafiriou (1989)</xref>) se usa para formular un autorregulador a trav&#x000e9;s de se&#x000f1;ales internalizadas que dependen de la funci&#x000f3;n de transferencia entre la entrada <italic toggle="yes">&#x003be;</italic><sub>4</sub> y la salida <italic toggle="yes">&#x003b7;</italic><sub>4</sub>, calculada a partir del modelo TCS.</p><p id="P20">En este trabajo, el uso de un modelo de identificaci&#x000f3;n estimado en base a datos elimina la necesidad de definir un auto-regulador; adicionalmente, dificultades durante <italic toggle="yes">Just Walk</italic> para obtener una medida confiable de <italic toggle="yes">auto-eficacia</italic> motivan el uso de la se&#x000f1;al de <italic toggle="yes">logro de metas</italic> para inferir si participantes en la intervenci&#x000f3;n est&#x000e1;n reaccionando negativamente a un objetivo demasiado alto que consideren dif&#x000ed;cil de alcanzar. Los beneficios de tal estrategia son parte del trabajo de <xref rid="R8" ref-type="bibr">El Mistiri et al. (2022)</xref>. La descripci&#x000f3;n de la intervenci&#x000f3;n <italic toggle="yes">Just Walk</italic> y el uso de m&#x000e9;todos de identificaci&#x000f3;n de sistemas para obtener un modelado din&#x000e1;mico se presentan en la secci&#x000f3;n siguiente.</p></sec><sec id="S3"><label>3.</label><title>Descripci&#x000f3;n de la intervenci&#x000f3;n <italic toggle="yes">Just Walk</italic></title><p id="P21"><italic toggle="yes">Just Walk</italic> se desarroll&#x000f3; como una aplicaci&#x000f3;n de intervenci&#x000f3;n adaptativa para niveles de caminata en adultos sedentarios con sobrepeso. Fue dise&#x000f1;ado principalmente como una herramienta para generar modelos computacionales individualizados para comprender el comportamiento de la actividad f&#x000ed;sica (AF) a trav&#x000e9;s de la identificaci&#x000f3;n del sistema. El sistema de intervenci&#x000f3;n inclu&#x000ed;a una aplicaci&#x000f3;n de Android front-end, <italic toggle="yes">Just Walk</italic> (<xref rid="F3" ref-type="fig">Figura 3</xref>), un servidor back-end y un rastreador de actividad (Fitbit Zip) para medir objetivamente la AF y sincronizar autom&#x000e1;ticamente con la aplicaci&#x000f3;n del tel&#x000e9;fono inteligente. Los participantes fueron reclutados a nivel nacional en Estados Unidos para participar en una intervenci&#x000f3;n de caminata y recibir objetivos de pasos diarios a trav&#x000e9;s de la aplicaci&#x000f3;n <italic toggle="yes">Just Walk</italic>, y se otorgaron puntos anunciados diariamente si los objetivos se lograban ese d&#x000ed;a; los puntos otorgados se convirtieron en tarjetas de regalo de Amazon despu&#x000e9;s de que se alcanzara un cierto umbral. Los participantes tambi&#x000e9;n deb&#x000ed;an completar una serie de medidas de evaluaci&#x000f3;n moment&#x000e1;nea ecol&#x000f3;gica matutina y vespertina diarias (EMA, <xref rid="R35" ref-type="bibr">Shiffman et al. (2008)</xref>; por ejemplo, confianza en el logro de la meta, actividad prevista para ese d&#x000ed;a, calidad del sue&#x000f1;o de la noche anterior, etc.) durante el tiempo que tomaba el estudio. Las mediciones EMA se basan en enfoques desarrollados recientemente para evaluar los procesos comportamentales y cognitivos en sus entornos naturales.</p><p id="P22">La duraci&#x000f3;n del estudio fue de 14 semanas, incluido un per&#x000ed;odo inicial de dos semanas en el que no necesariamente se cumplieron los objetivos de pasos. Los objetivos de pasos de cada participante se basaron luego en la media de pasos diarios realizados calculado a partir del per&#x000ed;odo de referencia de 14 d&#x000ed;as. Los objetivos de los pasos se dise&#x000f1;aron para establecer un mecanismo para individualizar la definici&#x000f3;n de un rango de pasos &#x0201c;ambicioso, pero factible&#x0201d;. Todos los datos de AF se recopilaron del Fitbit Zip (proporcionado a los participantes como parte del estudio) y se almacenaron tanto localmente como en Fitabase (Small Steps Labs, San Diego, CA, USA). Los participantes eran en general sanos, inactivos, de 40 a 65 a&#x000f1;os de edad, con un &#x000ed;ndice de masa corporal (IMC) de 25 a 45 kg/m<sup>2</sup>, que actualmente pose&#x000ed;an un tel&#x000e9;fono Android capaz de conectarse a un Fitbit Zip a trav&#x000e9;s de Bluetooth 4.0. y estaban dispuestos a participar en la intervenci&#x000f3;n de mHealth durante 14 semanas.</p><sec id="S4"><label>3.1.</label><title>Dise&#x000f1;o de se&#x000f1;al de entrada de Just Walk</title><p id="P23">El procedimiento de dise&#x000f1;o de la se&#x000f1;al de entrada utilizado en el estudio <italic toggle="yes">Just Walk</italic> (<xref rid="R12" ref-type="bibr">Hekler, 2015</xref>) se estableci&#x000f3; utilizando se&#x000f1;ales determin&#x000ed;sticas pero &#x0201c;pseudoaleatorias&#x0201d;que son ortogonales en el dominio de la frecuencia. El procedimiento se describe en detalle en <xref rid="R23" ref-type="bibr">Mart&#x000ed;n et al. (2015b)</xref>. En <italic toggle="yes">Just Walk</italic>, las se&#x000f1;ales <italic toggle="yes">Metas diarias</italic> establecen el comportamiento deseado en forma cuantitativa, mientras que <italic toggle="yes">Puntos esperados</italic> son los puntos disponibles diarios que se anuncian cada ma&#x000f1;ana y que se otorgan al alcanzar el objetivo. <italic toggle="yes">Metas diarias</italic> y <italic toggle="yes">Puntos esperados</italic> son dos se&#x000f1;ales de entrada manipuladas <italic toggle="yes">u</italic><sub><italic toggle="yes">n</italic></sub> generadas a partir de una se&#x000f1;al multiseno,
<disp-formula id="FD6">
<label>(6)</label>
<mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mtext>&#x02009;cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
</disp-formula>
donde <italic toggle="yes">&#x003bb;</italic><sub><italic toggle="yes">n</italic></sub> es el factor de escala, <italic toggle="yes">N</italic><sub><italic toggle="yes">s</italic></sub> es el n&#x000fa;mero de muestras por per&#x000ed;odo, <italic toggle="yes">T</italic><sub><italic toggle="yes">s</italic></sub> es el tiempo de muestreo. Para el <italic toggle="yes">j</italic><sup><italic toggle="yes">avo</italic></sup> arm&#x000f3;nico de la se&#x000f1;al, cada variable tiene el siguiente significado: <italic toggle="yes">&#x003b1;</italic><sub>[<italic toggle="yes">n</italic>,<italic toggle="yes">j</italic>]</sub> es un factor usado para especificar la potencia relativa del arm&#x000f3;nico, <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">j</italic></sub> es la frecuencia, y <italic toggle="yes">&#x003d5;</italic><sub>[<italic toggle="yes">n</italic>,<italic toggle="yes">j</italic>]</sub> es la fase. Para obtener estimaciones independientes de la funci&#x000f3;n de transferencia y de la incertidumbre, se eligen factores <italic toggle="yes">&#x003b1;</italic><sub>[<italic toggle="yes">n</italic>,<italic toggle="yes">j</italic>]</sub> para excitar las se&#x000f1;ales de entrada ortogonalmente en frecuencia. Dos se&#x000f1;ales son ortogonales si un coeficiente de Fourier distinto de cero a una frecuencia espec&#x000ed;fica en una se&#x000f1;al, implica un coeficiente de Fourier de valor cero a la misma frecuencia para la otra; esto se llama un dise&#x000f1;o de espectros con cremallera (&#x0201c;zippered&#x0201d;), una idea introducida en in <xref rid="R34" ref-type="bibr">Rivera et al. (2009)</xref>. En la <xref rid="F4" ref-type="fig">Figura 4</xref> se presenta una representaci&#x000f3;n conceptual del dise&#x000f1;o &#x0201c;con cremallera&#x0201d;. Para <italic toggle="yes">n</italic><sub><italic toggle="yes">u</italic></sub> entradas de dise&#x000f1;o y <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> sinusoides excitados independientemente, los coeficientes de Fourier se especifican como
<disp-formula id="FD7">
<label>(7)</label>
<mml:math id="M7" display="block"><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>si&#x02009;</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>para&#x02009;</mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>en&#x000a0;otro&#x000a0;lado</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math>
</disp-formula></p><p id="P24">Usando las frecuencias <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">j</italic></sub> definidas (<xref rid="FD6" ref-type="disp-formula">6</xref>) y el teorema de muestreo de Nyquist Shannon, se define el siguiente l&#x000ed;mite para <italic toggle="yes">N</italic><sub><italic toggle="yes">s</italic></sub>:
<disp-formula id="FD8">
<label>(8)</label>
<mml:math id="M8" display="block"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math>
</disp-formula>
Si se seleccionan <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> = 6 sinusoides excitadas para las entradas de dise&#x000f1;o <italic toggle="yes">n</italic><sub><italic toggle="yes">u</italic></sub> = 2, entonces al aplicar (<xref rid="FD8" ref-type="disp-formula">8</xref>), <italic toggle="yes">N</italic><sub><italic toggle="yes">s</italic></sub> = 16 d&#x000ed;as (seleccionados) es una opci&#x000f3;n factible. Las fases <italic toggle="yes">&#x003d5;</italic><sub>[<italic toggle="yes">n</italic>,<italic toggle="yes">j</italic>]</sub> se seleccionan para minimizar el factor de cresta de la se&#x000f1;al utilizando el enfoque propuesto por <xref rid="R11" ref-type="bibr">Guillaume et al. (1991)</xref>.</p><p id="P26">Al aplicar esta metodolog&#x000ed;a de dise&#x000f1;o para <italic toggle="yes">Just Walk</italic>, se eligieron las amplitudes de las se&#x000f1;ales de entrada (<italic toggle="yes">u</italic><sub>8</sub> y <italic toggle="yes">u</italic><sub>9</sub> en la <xref rid="F5" ref-type="fig">Figura 5</xref>) bas&#x000e1;ndose en experiencias de estudios anteriores (<xref rid="R16" ref-type="bibr">King et al., 2013</xref>; <xref rid="R1" ref-type="bibr">Adams et al., 2013</xref>) dise&#x000f1;ados para obtener un perfil esperado de AF. El n&#x000fa;mero m&#x000e1;ximo de objetivos de pasos se seleccion&#x000f3; como un factor del nivel de referencia inicial de AF. Para la mayor&#x000ed;a de los casos en este dise&#x000f1;o experimental, este factor fue igual a 2; sin embargo, se vari&#x000f3; si el nivel de pasos de la l&#x000ed;nea de base real de los individuos era demasiado alto o bajo. Espec&#x000ed;ficamente, si los pasos de la mediana de la l&#x000ed;nea de base del participante estaban por debajo de 3000, entonces el rango de las metas estaba entre 1 y 2.5 de sus pasos de la mediana de la l&#x000ed;nea de base, para aumentar la probabilidad de metas &#x0201c;ambiciosas&#x0201d;. Si los pasos medianos de la l&#x000ed;nea de base eran mayores de 7500, entonces el rango se estableci&#x000f3; entre 1 y 1,75 (para reducir la probabilidad de metas demasiado ambiciosas, como 15 000 pasos en un d&#x000ed;a). Adem&#x000e1;s de los dos canales de entrada manipulados, tambi&#x000e9;n se midi&#x000f3; un considerable conjunto de perturbaciones utilizando tecnolog&#x000ed;as mHealth. La duraci&#x000f3;n experimental general m&#x000e1;s all&#x000e1; de la l&#x000ed;nea de base vari&#x000f3; entre cinco y seis ciclos para cada participante. En la <xref rid="F5" ref-type="fig">Figura 5</xref> se muestra un gra&#x000ed;fico de series de tiempo para un participante representativo que describe el comportamiento y cuatro se&#x000f1;ales de entrada.</p></sec><sec id="S5"><label>3.2.</label><title>Estimaci&#x000f3;n del modelo ARX &#x00026; Validaci&#x000f3;n</title><p id="P27">En esta secci&#x000f3;n, se describen las estrategias de estimaci&#x000f3;n del modelo utilizadas para <italic toggle="yes">Just Walk</italic> y se presentan los resultados de ajustar modelos param&#x000e9;tricos (ARX) Auto Regresivos con entradas eX&#x000f3;genas (<xref rid="R19" ref-type="bibr">Ljung, 1999</xref>). La estimaci&#x000f3;n de modelos de caja negra como ARX es un paso inicial que juega un papel fundamental en el objetivo final de identificar modelos <italic toggle="yes">personalizados</italic> semif&#x000ed;sicos (caja gris) que se ajusten a la estructura de TCS indicada en la secci&#x000f3;n 2 (<xref rid="R26" ref-type="bibr">Mart&#x000ed;n et al., 2020</xref>). Antes de la estimaci&#x000f3;n ARX, se aplica una estimaci&#x000f3;n no param&#x000e9;trica est&#x000e1;ndar, como el an&#x000e1;lisis de correlaci&#x000f3;n. Debido a que el estudio <italic toggle="yes">Just Walk</italic> incluy&#x000f3; una amplia gama de medidas de entrada y salida, los resultados de los an&#x000e1;lisis de correlaci&#x000f3;n entradasalida y entrada-entrada resultaron &#x000fa;tiles (<xref rid="R32" ref-type="bibr">Phatak et al., 2018</xref>); por razones de brevedad, no se incluyen en este documento. La incorporaci&#x000f3;n de todas las perturbaciones medidas para estimar un modelo de comportamiento de TCS (en particular, el constructo <italic toggle="yes">Contexto ambiental</italic> en la <xref rid="F1" ref-type="fig">Figura 1</xref>) puede ser computacionalmente exigente; tambi&#x000e9;n, imponer desaf&#x000ed;os de identificabilidad inherentes que requerir&#x000e1;n grandes conjuntos de datos es un requisito t&#x000ed;picamente dif&#x000ed;cil en investigaci&#x000f3;n con sujetos humanos; por lo tanto, vale la pena esforzarse por reducir la dimensi&#x000f3;n del problema de estimaci&#x000f3;n (<xref rid="R10" ref-type="bibr">Freigoun et al., 2017</xref>; <xref rid="R15" ref-type="bibr">Kha et al., 2022</xref>).</p><p id="P28">Los datos preprocesados se ajustan a una estructura de modelo ARX, <inline-formula><mml:math id="M9" display="inline"><mml:mrow><mml:mtext>ARX</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> que se puede expresar de forma concisa en la siguiente forma:
<disp-formula id="FD9">
<label>(9)</label>
<mml:math id="M10" display="block"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
donde <italic toggle="yes">y</italic>(<italic toggle="yes">t</italic>) es la salida medida (por ejemplo, pasos / d&#x000ed;a), <italic toggle="yes">u</italic><sub><italic toggle="yes">j</italic></sub>(<italic toggle="yes">t</italic>) es la entrada (por ejemplo, meta en pasos / d&#x000ed;a), y <italic toggle="yes">e</italic>(<italic toggle="yes">t</italic>) es el error de predicci&#x000f3;n, todos medidos o estimados para el d&#x000ed;a <italic toggle="yes">t</italic>. El problema de estimaci&#x000f3;n de par&#x000e1;metros ARX correspondiente a (<xref rid="FD9" ref-type="disp-formula">9</xref>) es una regresi&#x000f3;n lineal de m&#x000ed;nimos cuadrados regularizada (<xref rid="R33" ref-type="bibr">Pillonetto et al., 2014</xref>; <xref rid="R20" ref-type="bibr">Ljung et al., 2015</xref>). Espec&#x000ed;ficamente, en este trabajo se utiliza la regularizaci&#x000f3;n del kernel ajustada / correlacionada (AC; <xref rid="R4" ref-type="bibr">Chen et al. (2011)</xref>), que tiene propiedades estad&#x000ed;sticas atractivas (como la consistencia y la reducci&#x000f3;n de la varianza inducida por ruido).</p><sec id="S6"><label>3.2.1.</label><title>Consideraciones sobre el preprocesamiento de datos y la estructura del modelo</title><p id="P30">Las tareas de preprocesamiento de datos incluyen la inter-polaci&#x000f3;n (para tener en cuenta los datos faltantes), la resta media y el desplazamiento de <italic toggle="yes">Pasos reales</italic> y <italic toggle="yes">Puntos concedidos</italic> en una muestra para reflejar la precedencia temporal. Las decisiones de selecci&#x000f3;n de la estructura del modelo consisten en determinar, para cada participante, las se&#x000f1;ales de entrada que se incluir&#x000e1;n y los correspondientes &#x000f3;rdenes del modelo ARX para la salida y cada entrada, de acuerdo con (<xref rid="FD9" ref-type="disp-formula">9</xref>). El conocimiento <italic toggle="yes">a priori</italic> del modelo de analog&#x000ed;a de fluidos TSC desarrollado en <xref rid="R26" ref-type="bibr">Mart&#x000ed;n et al. (2020)</xref> implica que los modelos de muy alto orden no deber&#x000ed;an ser necesarios para representar adecuadamente estas din&#x000e1;micas de cambio de comportamiento. El orden elegido para el modelo ARX es de segundo orden en la salida y primer orden en todas las entradas consideradas (es decir, <italic toggle="yes">n</italic><sub><italic toggle="yes">a</italic></sub> = 2, <inline-formula><mml:math id="M11" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>&#x02003;</mml:mtext><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>). Al inspeccionar los datos de la intervenci&#x000f3;n, fue razonable suponer un retraso de entrada de la unidad basica (es decir., <inline-formula><mml:math id="M12" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>&#x02003;</mml:mtext><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>). Finalmente, la ausencia de desviaciones en los datos lleva a asumir caracter&#x000ed;sticas de ruido estacionario (aunque potencialmente variable en el tiempo) durante el transcurso del per&#x000ed;odo de intervenci&#x000f3;n.</p><p id="P31">Para determinar las entradas a considerar, se realiza un trabajo extenso para evaluar todas las posibles combinaciones de entrada para cada participante (<xref rid="R32" ref-type="bibr">Phatak et al., 2018</xref>; <xref rid="R10" ref-type="bibr">Freigoun et al., 2017</xref>). Para el participante representativo de la <xref rid="F5" ref-type="fig">Figura 5</xref>, un modelo de 4 entradas que consta de las se&#x000f1;ales en la <xref rid="T1" ref-type="table">Tabla 1</xref> proporciona una representaci&#x000f3;n suficiente de la din&#x000e1;mica del sistema. Es importante tener en cuenta que <italic toggle="yes">Metas diarias</italic> (<italic toggle="yes">u</italic><sub>8</sub>), y <italic toggle="yes">Puntos esperados</italic> (<italic toggle="yes">u</italic><sub>9</sub>) son entradas manipuladas estad&#x000ed;sticamente independientes, mientras que <italic toggle="yes">Puntos concedidos</italic> (<italic toggle="yes">u</italic><sub>10</sub>) depende del cumplimiento de los objetivos. <italic toggle="yes">Contexto ambiental: temperatura</italic>
<inline-formula><mml:math id="M13" display="inline"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:msub><mml:mn>7</mml:mn><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> presenta una se&#x000f1;al ex&#x000f3;gena en forma de cambios en la temperatura promedio diaria y corresponde a una variable de perturbaci&#x000f3;n medida.</p></sec><sec id="S7"><label>3.2.2.</label><title>Estimaci&#x000f3;n y validaci&#x000f3;n de par&#x000e1;metros del modelo</title><p id="P32">Ahora se considera la estimaci&#x000f3;n del modelo y la validaci&#x000f3;n concomitante con los datos de intervenci&#x000f3;n <italic toggle="yes">Just Walk</italic> utilizando el modelo ARX de 4 entradas presentado anteriormente. La validaci&#x000f3;n cruzada (el proceso de evaluar el ajuste del modelo sobre los datos no utilizados para la estimaci&#x000f3;n) representa uno de los aspectos m&#x000e1;s valiosos de la identificaci&#x000f3;n del sistema (<xref rid="R18" ref-type="bibr">Ljung, 1994</xref>). El enfoque convencional en la identificaci&#x000f3;n de sistemas es asignar un cierto porcentaje de datos para la estimaci&#x000f3;n y el resto para la validaci&#x000f3;n. Este enfoque supone que las caracter&#x000ed;sticas de ruido del problema permanecen sin cambios durante el curso de la intervenci&#x000f3;n. En este trabajo, el 50 % inicial de los datos se utiliza para la validaci&#x000f3;n y la segunda mitad para la estimaci&#x000f3;n.</p><p id="P33">La <xref rid="F5" ref-type="fig">Figura 5</xref> ilustra la diferencia entre las medidas de salida reales y la predicci&#x000f3;n de un modelo ARX de 4 entradas con la estructura que se muestra en la ecuaci&#x000f3;n (<xref rid="FD9" ref-type="disp-formula">9</xref>). A continuaci&#x000f3;n, se presenta una discusi&#x000f3;n detallada de las estrategias de modelado de caja negra utilizadas en este trabajo. Para cuantificar los ajustes del modelo, se utiliza el &#x000ed;ndice de ajuste del error cuadr&#x000e1;tico medio normalizado (NRMSE)
<disp-formula id="FD10">
<label>(10)</label>
<mml:math id="M14" display="block"><mml:mrow><mml:mtext>ajuste&#x000a0;al&#x000a0;modelo&#x02009;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>%</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mo>&#x02225;</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>&#x02225;</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>&#x02225;</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:msub><mml:mo>&#x02225;</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
<italic toggle="yes">y</italic>(<italic toggle="yes">k</italic>) es la salida medida, <inline-formula><mml:math id="M15" display="inline"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> es la salida simulada, <inline-formula><mml:math id="M16" display="inline"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> es la media de todos los valores <italic toggle="yes">y</italic>(<italic toggle="yes">k</italic>), y &#x02225; &#x000b7; &#x02225;<sub>2</sub> indica un vector norma-<italic toggle="yes">l</italic><sub>2</sub>. El modelo obtenido refleja, adem&#x000e1;s de un buen ajuste a los datos de validaci&#x000f3;n, un buen ajuste para todo el conjunto de datos (que consta de ciclos de estimaci&#x000f3;n y validacion). El modelo ARX obtenido con la regularizaci&#x000f3;n del kernel TC del sistema de 4 entradas arroja un &#x000ed;ndice NRMSE general de 48.74 % (ajuste de validaci&#x000f3;n de 61.73 % y 37.02% para estimaci&#x000f3;n). La incorporaci&#x000f3;n del criterio de ajuste general con el ajuste a los datos de validaci&#x000f3;n cruzada equilibra una buena predicci&#x000f3;n con la precisi&#x000f3;n del modelo en todo el conjunto de datos.</p></sec><sec id="S8"><label>3.2.3.</label><title>Evaluaci&#x000f3;n de las caracter&#x000ed;sticas de los participantes individuales</title><p id="P34">El modelo ARX estimado proporciona la base para la simulaci&#x000f3;n como planta y para el modelo de controlador MPC. Es esencial que el modelo estimado no solo proporcione un buen ajuste a los datos, sino que tambi&#x000e9;n est&#x000e9; orientado al control y proporcione informaci&#x000f3;n importante sobre las se&#x000f1;ales de mayor impacto en un participante espec&#x000ed;fico para la personalizaci&#x000f3;n de las intervenciones. Si bien las tareas de modelado no param&#x000e9;trico, como los an&#x000e1;lisis correlacionales, son informativas en t&#x000e9;rminos de determinar las se&#x000f1;ales y entradas correlacionadas cruzadas que se deben incluir, las respuestas escalonadas de los modelos ARX individuales se pueden usar para revelar informaci&#x000f3;n de magnitud y direccionalidad m&#x000e1;s precisa. Por ejemplo, a partir de la <xref rid="F6" ref-type="fig">Figura 6</xref>, se puede predecir que el participante seleccionado t&#x000ed;picamente alcanzar&#x000e1; aproximadamente el 74 % de los objetivos de pasos diarios deseados dentro del primer d&#x000ed;a del anuncio del objetivo. La entrada <italic toggle="yes">Puntos esperados</italic> tiene el impacto m&#x000e1;s significativo en la cantidad de pasos que caminaron fuera de las variables manipuladas, mientras que <italic toggle="yes">Puntos otorgados</italic> tiene la magnitud de ganancia m&#x000e1;s baja. Adem&#x000e1;s, las respuestas escalonadas muestran que una perturbaci&#x000f3;n ex&#x000f3;gena en forma de <italic toggle="yes">Contexto ambiental: temperatura</italic> influye mucho en la salida. Esto tiene importantes implicaciones para las intervenciones de cambio de comportamiento personalizadas y adaptativas; si se pueden determinar las entradas que son m&#x000e1;s significativas para un individuo dado en un contexto dado, entonces es posible optimizar el comportamiento objetivo durante un tiempo espec&#x000ed;fico (horas, d&#x000ed;as, semanas, meses).</p></sec></sec></sec><sec id="S9"><label>4.</label><title>Formulaci&#x000f3;n de la intervenci&#x000f3;n adaptativa basada en HMPC</title><p id="P35">El prop&#x000f3;sito de la intervenci&#x000f3;n adaptativa es que las personas alcancen el nivel deseado de pasos diarios, al tiempo que se consideran algunas limitaciones f&#x000ed;sicas y operativas importantes, tales como:
<list list-type="bullet" id="L6"><list-item><p id="P36">Valores m&#x000e9;ximos y m&#x000ed;nimos de metas y puntos. (<italic toggle="yes">u</italic><sub>8</sub>, <italic toggle="yes">u</italic><sub>9</sub> y <italic toggle="yes">u</italic><sub>10</sub>) dependiendo de las condiciones f&#x000ed;sicas y las limitaciones econ&#x000f3;micas.</p></list-item><list-item><p id="P37">Las metas y los puntos de recompensa deben obtenerse de conjuntos discretos de valores enteros que pueden representar efectos significativos en la intervenci&#x000f3;n.</p></list-item><list-item><p id="P38">La intervenci&#x000f3;n puede configurarse en diferentes etapas durante las cuales algunas de las entradas pueden activarse o desactivarse parcialmente. Por ejemplo, cuando el comportamiento ha alcanzado el nivel deseado y se mantiene con &#x000e9;xito, las recompensas pueden reducirse gradualmente y finalmente desactivarse.</p></list-item></list>
Las subsecciones siguientes describen la intervenci&#x000f3;n detallada de la pol&#x000ed;tica de decisiones basada en HMPC.</p><sec id="S10"><label>4.1.</label><title>Uso del marco HMPC</title><p id="P40">La estrategia de control para el dise&#x000f1;o de la intervenci&#x000f3;n debe incorporar los requisitos y restricciones definidos para la intervenci&#x000f3;n comportamental de actividad f&#x000ed;sica. En una intervenci&#x000f3;n real, la definici&#x000f3;n de las restricciones depender&#x000e1; de las circunstancias y condiciones de cada individuo y deber&#x000e1;n ser parte de una evaluaci&#x000f3;n inicial previa al desarrollo de la misma. Se estudiar&#x000e1; m&#x000e1;s a fondo una estrategia de control predictivo de modelo h&#x000ed;brido (HMPC) (<xref rid="R29" ref-type="bibr">Nandola and Rivera, 2013</xref>) y se aplicar&#x000e1; a este problema, ya que incorpora din&#x000e1;mica h&#x000ed;brida a trav&#x000e9;s de representaciones din&#x000e1;micas l&#x000f3;gicas mixtas (DLM); esta caracter&#x000ed;stica se puede utilizar para representar las limitaciones naturales del problema. Los sistemas din&#x000e1;micos h&#x000ed;bridos consideran eventos discretos y continuos simult&#x000e1;neamente; estos se pueden representar mediante ecuaciones diferenciales (o en diferencias) y condiciones l&#x000f3;gicas que describen su respuesta categ&#x000f3;rica o binaria. El objetivo del dise&#x000f1;o del control estar&#x000e1; dirigido a las siguientes tareas:
<list list-type="bullet" id="L8"><list-item><p id="P41"><bold>Seguimiento del valor fijado:</bold> Se asignan metas y puntos de recompensa esperados para obtener la cantidad deseada de pasos diarios.</p></list-item><list-item><p id="P42"><bold>Rechazo de perturbaciones medido:</bold> El controlador manipula los objetivos y los puntos esperados para mitigar el efecto de las perturbaciones externas medidas. (e.g., <italic toggle="yes">su contexto ambiental</italic>)).</p></list-item><list-item><p id="P43"><bold>Rechazo de perturbaciones no medidas:</bold> Las entradas se manipulan para mitigar el efecto de influencias externas desconocidas y posiblemente no modeladas (e.g., enfermedad de un miembro de la familia, invitaci&#x000f3;n repentina a una fiesta).</p></list-item></list></p><p id="P44">El control predictivo del modelo es una intervenci&#x000f3;n de controlador donde los valores actuales de las variables manipuladas se determinan en tiempo real como la soluci&#x000f3;n de un problema de control &#x000f3;ptimo en un horizonte de longitud determinada. El problema de optimizaci&#x000f3;n se resuelve para un horizonte m&#x000f3;vil utilizando un modelo a partir del cual se obtiene un nuevo conjunto de movimientos de control; las salidas del sistema se calculan luego sobre el horizonte de predicci&#x000f3;n con la estimaci&#x000f3;n del estado actual de la planta (es decir, la medici&#x000f3;n de la salida) asumida como el estado inicial. Solo los primeros movimientos calculados se aplican en cada instante; a continuaci&#x000f3;n, se repite todo el proceso y se obtienen nuevos movimientos de control.</p><p id="P45">El controlador HMPC se basa en la siguiente estructura:
<disp-formula id="FD11">
<label>(11)</label>
<mml:math id="M17" display="block"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD12">
<label>(12)</label>
<mml:math id="M18" display="block"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD13">
<label>(13)</label>
<mml:math id="M19" display="block"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
donde en general <inline-formula><mml:math id="M20" display="inline"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M21" display="inline"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>&#x0211d;</mml:mi><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M22" display="inline"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M23" display="inline"><mml:mrow><mml:mtext>y&#x02009;</mml:mtext><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M24" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>&#x0211d;</mml:mi><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M25" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> son estados de sistemas y entradas con elementos continuos y discretos; <inline-formula><mml:math id="M26" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>&#x0211d;</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> es el vector de salidas; <italic toggle="yes">d</italic>, <italic toggle="yes">d</italic>&#x02032;, y <italic toggle="yes">v</italic> son perturbaciones medidas, perturbaciones no medidas y ruido de medici&#x000f3;n, respectivamente. <inline-formula><mml:math id="M27" display="inline"><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> y <inline-formula><mml:math id="M28" display="inline"><mml:mrow><mml:mi>z</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>&#x0211d;</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> son variables auxiliares discretas y continuas que se introducen para convertir decisiones l&#x000f3;gicas y discretas en sus restricciones de desigualdad lineal equivalentes representadas en la ecuaci&#x000f3;n (<xref rid="FD13" ref-type="disp-formula">13</xref>). Las variables <inline-formula><mml:math id="M29" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M30" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">n</italic><sub><italic toggle="yes">dist</italic></sub>, y <italic toggle="yes">n</italic><sub><italic toggle="yes">y</italic></sub> son el n&#x000fa;mero total de estados, entradas, perturbaciones medidas y salidas, respectivamente. Se usa una funci&#x000f3;n de costo cuadr&#x000e1;tico est&#x000e1;ndar para calcular el vector de decisi&#x000f3;n para el problema de optimizaci&#x000f3;n como
<disp-formula id="FD14">
<label>(14)</label>
<mml:math id="M31" display="block"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x0225c;</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msubsup><mml:mrow><mml:mrow><mml:mo>&#x02016;</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02016;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>&#x02225;</mml:mo><mml:mi>&#x00394;</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>&#x02225;</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mrow><mml:mo>&#x02016;</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02016;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mrow><mml:mo>&#x02016;</mml:mo><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02016;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mrow><mml:mo>&#x02016;</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02016;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</disp-formula>
donde <italic toggle="yes">p</italic> es el horizonte de predicci&#x000f3;n, <italic toggle="yes">m</italic> es el horizonte de control (o movimiento). Las matrices <italic toggle="yes">Q</italic><sub><italic toggle="yes">y</italic></sub>, <italic toggle="yes">Q</italic><sub>&#x00394;<italic toggle="yes">u</italic></sub>, <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>, <italic toggle="yes">Q</italic><sub><italic toggle="yes">6</italic></sub>, y <italic toggle="yes">Q</italic><sub><italic toggle="yes">z</italic></sub> son los pesos de penalizaci&#x000f3;n sobre el error, el tama&#x000f1;o del movimiento, la se&#x000f1;al de control, las variables binarias auxiliares y las variables continuas auxiliares, respectivamente. El problema se formula como un sistema de control de seguimiento donde <italic toggle="yes">y</italic><sub><italic toggle="yes">r</italic></sub>, <italic toggle="yes">u</italic><sub><italic toggle="yes">r</italic></sub>, <italic toggle="yes">&#x003b4;</italic><sub><italic toggle="yes">r</italic></sub>, y <italic toggle="yes">z</italic><sub><italic toggle="yes">r</italic></sub> son las referencias para las variables auxiliares de salida, entrada, discretas y continuas, respectivamente. El problema de optimizaci&#x000f3;n consiste en encontrar las secuencias de acciones de control que minimiza <italic toggle="yes">J</italic> como
<disp-formula id="FD15">
<label>(15)</label>
<mml:math id="M32" display="block"><mml:mrow><mml:munder><mml:mrow><mml:mtext>m&#x000ed;n&#x000a0;</mml:mtext></mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>J</mml:mi></mml:mrow></mml:math>
</disp-formula>
sujeto a las restricciones de enteros mixtos descritas en la ecuaci&#x000f3;n (<xref rid="FD13" ref-type="disp-formula">13</xref>) y varias restricciones de proceso:
<disp-formula id="FD16">
<label>(16)</label>
<mml:math id="M33" display="block"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext mathvariant="italic">min</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext mathvariant="italic">max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">&#x02003;</mml:mtext><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD17">
<label>(17)</label>
<mml:math id="M34" display="block"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">min</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">&#x02003;</mml:mtext><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD18">
<label>(18)</label>
<mml:math id="M35" display="block"><mml:mrow><mml:mtext mathvariant="italic">&#x00394;</mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">min</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mtext mathvariant="italic">&#x00394;</mml:mtext><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mtext mathvariant="italic">&#x00394;</mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">max</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">&#x02003;</mml:mtext><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>
</disp-formula></p><p id="P49">La intervenci&#x000f3;n HMPC utiliza una estructura de ajuste de tres grados de libertad, donde el seguimiento del valor fijado, los rechazos de perturbaciones medidos y no medidos se pueden ajustar de forma independiente mediante la variaci&#x000f3;n de los par&#x000e1;metros <inline-formula><mml:math id="M36" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M37" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mtext>&#x02009;y&#x02009;</mml:mtext><mml:msubsup><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> de 0 a 1, para <italic toggle="yes">j</italic> = 1, &#x022ef;, <italic toggle="yes">n</italic><sub><italic toggle="yes">y</italic></sub>, y <italic toggle="yes">l</italic> = 1, &#x022ef;, <italic toggle="yes">n</italic><sub><italic toggle="yes">dist</italic></sub>. Para el seguimiento del punto de ajuste, una matriz de filtro <italic toggle="yes">F</italic>(<italic toggle="yes">q</italic>, <italic toggle="yes">&#x003b1;</italic><sub><italic toggle="yes">r</italic></sub>) se define como
<disp-formula id="FD19">
<label>(19)</label>
<mml:math id="M38" display="block"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
donde cada elemento es un filtro de tiempo discreto de Tipo I
<disp-formula id="FD20">
<label>(20)</label>
<mml:math id="M39" display="block"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math>
</disp-formula>
Para el rechazo de perturbaciones medidas, la formulaci&#x000f3;n se basa en un pron&#x000f3;stico generado externamente que se procesa a trav&#x000e9;s del filtro <italic toggle="yes">F</italic>(<italic toggle="yes">q</italic>, <italic toggle="yes">&#x003b1;</italic><sub><italic toggle="yes">d</italic></sub>). En este trabajo se consideran los filtros Tipo I:
<disp-formula id="FD21">
<label>(21)</label>
<mml:math id="M40" display="block"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext mathvariant="italic">dist</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD22">
<label>(22)</label>
<mml:math id="M41" display="block"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext mathvariant="italic">dist</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>
</disp-formula>
El optimizador usa el modelo y las medidas actuales <italic toggle="yes">y</italic>(<italic toggle="yes">k</italic>) para calcular estados futuros a trav&#x000e9;s de un observador / filtro como se describe con detalles en (<xref rid="R29" ref-type="bibr">Nandola and Rivera, 2013</xref>). El observador pondera el efecto de las perturbaciones no medidas a trav&#x000e9;s de una matriz de ganancia.
<disp-formula id="FD23">
<label>(23)</label>
<mml:math id="M42" display="block"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math>
</disp-formula>
donde <inline-formula><mml:math id="M43" display="inline"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, y <inline-formula><mml:math id="M44" display="inline"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Para la intervenci&#x000f3;n de actividad f&#x000ed;sica, los vectores de entrada y salida son
<disp-formula id="FD24">
<label>(24)</label>
<mml:math id="M45" display="block"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD25">
<label>(25)</label>
<mml:math id="M46" display="block"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD26">
<label>(26)</label>
<mml:math id="M47" display="block"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math>
</disp-formula>
El contexto ambiental <italic toggle="yes">&#x003be;</italic><sub>7</sub> se considera como parte de la perturbaci&#x000f3;n medida <italic toggle="yes">d</italic>, al igual que los puntos otorgados <italic toggle="yes">u</italic><sub>10</sub>. La perturbaci&#x000f3;n no medida se supone gaussiana y afecta solo a los pasos diarios realizados (es decir, se le a&#x000f1;ade solo a la salida <italic toggle="yes">y</italic><sub>4</sub> = <italic toggle="yes">&#x003b7;</italic><sub>4</sub>).</p></sec><sec id="S11"><label>4.2.</label><title>Restricciones l&#x000f3;gicas y discretas</title><p id="P51">Los componentes de la intervenci&#x000f3;n toman sus valores de conjuntos discretos de eventos, el posible conjunto de objetivos de pasos se define como <inline-formula><mml:math id="M48" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, y el posible conjunto de puntos disponibles es <inline-formula><mml:math id="M49" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, por lo tanto, las siguientes variables auxiliares l&#x000f3;gicas y continuas se definen como
<disp-formula id="FD27">
<label>(27)</label>
<mml:math id="M50" display="block"><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x021d4;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math>
</disp-formula>
Esta condici&#x000f3;n es impuesta por
<disp-formula id="FD28">
<label>(28)</label>
<mml:math id="M51" display="block"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math>
</disp-formula>
Para asegurar que solo se pueda asignar un valor a <italic toggle="yes">u</italic><sub>8</sub> y <italic toggle="yes">u</italic><sub>9</sub> en cada tiempo de muestreo, es necesario agregar las siguientes restricciones:
<disp-formula id="FD29">
<label>(29)</label>
<mml:math id="M52" display="block"><mml:mrow><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD30">
<label>(30)</label>
<mml:math id="M53" display="block"><mml:mrow><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x02003;</mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula></p><p id="P501">El efecto de todas las entradas en un d&#x000ed;a determinado se reflejar&#x000e1; en las salidas del d&#x000ed;a siguiente, por lo que el n&#x000fa;mero de pasos realizados <italic toggle="yes">y</italic><sub>4</sub>(<italic toggle="yes">k</italic>) es el resultado de las metas y puntos del d&#x000ed;a anterior <italic toggle="yes">u</italic><sub>8</sub>(<italic toggle="yes">k</italic> &#x02212; 1), <italic toggle="yes">u</italic><sub>9</sub>(<italic toggle="yes">k</italic> &#x02212; 1), y <italic toggle="yes">u</italic><sub>10</sub>(<italic toggle="yes">k</italic> &#x02212; 1). De acuerdo con la intervenci&#x000f3;n propuesta que se muestra en la <xref rid="F2" ref-type="fig">Figura 2</xref>, el bloque &#x0201c;Si / Entonces&#x0201d; es el encargado de determinar si se otorgan los puntos, en funci&#x000f3;n del cumplimiento de las metas diarias. En un trabajo anterior (<xref rid="R25" ref-type="bibr">Mart&#x000ed;n et al., 2016</xref>) se aplic&#x000f3; una reformulaci&#x000f3;n de la matriz de gran-M para convertir la l&#x000f3;gica de esta restricci&#x000f3;n l&#x000f3;gica en un conjunto de condiciones lineales que, en consecuencia, impactan en una variable l&#x000f3;gica auxiliar. Como una variante al enfoque anterior, en este trabajo la restricci&#x000f3;n l&#x000f3;gica se aplica a trav&#x000e9;s de una declaraci&#x000f3;n &#x0201c;si.<sup>ex</sup>presada fuera del problema de optimizaci&#x000f3;n.
<disp-formula id="FD31">
<label>(31)</label>
<mml:math id="M54" display="block"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x021d4;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</disp-formula>
Este enfoque permite considerar <italic toggle="yes">Puntos concedidos</italic> como una perturbaci&#x000f3;n medida para desalentar el uso de recompensas econ&#x000f3;micas en la intervenci&#x000f3;n. Adem&#x000e1;s, este enfoque reduce la carga computacional sobre el problema de optimizaci&#x000f3;n, lo que disminuye el tiempo de ejecuci&#x000f3;n y permite c&#x000e1;lculos en l&#x000ed;nea m&#x000e1;s r&#x000e1;pidos.</p><p id="P52">Las restricciones descritas por las ecuaciones (<xref rid="FD27" ref-type="disp-formula">27</xref>) &#x02013; (<xref rid="FD30" ref-type="disp-formula">30</xref>) se incorporan al sistema presentado en la ecuaci&#x000f3;n (<xref rid="FD13" ref-type="disp-formula">13</xref>) definiendo los valores para las matrices <italic toggle="yes">E</italic><sub>1</sub>, <italic toggle="yes">E</italic><sub>2</sub>, <italic toggle="yes">E</italic><sub>3</sub>, <italic toggle="yes">E</italic><sub>4</sub>, <italic toggle="yes">E</italic><sub>5</sub>, y <italic toggle="yes">E</italic><sub><italic toggle="yes">d</italic></sub>. Puede encontrar una descripci&#x000f3;n m&#x000e1;s detallada en (<xref rid="R29" ref-type="bibr">Nandola and Rivera, 2013</xref>).</p></sec><sec id="S12"><label>4.3.</label><title>Etapa de formaci&#x000f3;n de mantenimiento</title><p id="P53">Una vez que se ha alcanzado el objetivo deseado y se ha mantenido durante un n&#x000fa;mero predeterminado de d&#x000ed;as, se inicia una etapa de entrenamiento de mantenimiento de la intervenci&#x000f3;n. Aqu&#x000ed; el algoritmo HMPC debe reconfigurarse para mantener los pasos diarios realizados a pesar de una reducci&#x000f3;n del n&#x000fa;mero de puntos y, si es necesario, reactivar el uso de puntos si ocurre una reca&#x000ed;da significativa. Para adaptar el rendimiento de HMPC a estas nuevas consideraciones, los pesos de penalizaci&#x000f3;n en la funci&#x000f3;n objetivo se ajustan durante el curso de la intervenci&#x000f3;n.</p><p id="P54">Durante la fase de iniciaci&#x000f3;n, el objetivo principal es lograr los pasos diarios requeridos. El punto de referencia de salida es <italic toggle="yes">y</italic><sub><italic toggle="yes">r</italic></sub> = [<italic toggle="yes">y</italic><sub><italic toggle="yes">r</italic>4</sub>
<italic toggle="yes">y</italic><sub><italic toggle="yes">r</italic>7</sub>]<sup><italic toggle="yes">T</italic></sup>, donde <italic toggle="yes">y</italic><sub><italic toggle="yes">r</italic>4</sub> es la cantidad deseada de pasos (por ejemplo, 10000). Considerando los vectores <italic toggle="yes">u</italic> y <italic toggle="yes">y</italic> definidos en las ecuaci&#x000f3;nes (<xref rid="FD24" ref-type="disp-formula">24</xref>)-(<xref rid="FD25" ref-type="disp-formula">25</xref>), la matriz de peso <italic toggle="yes">Q</italic><sub><italic toggle="yes">y</italic></sub> se establece en la funci&#x000f3;n objetivo (<xref rid="FD14" ref-type="disp-formula">14</xref>) para imponer un seguimiento del valor fijado solo en la variable <italic toggle="yes">y</italic><sub>4</sub> (pasos diarios). Las matrices de peso restantes en la ecuaci&#x000f3;n (<xref rid="FD14" ref-type="disp-formula">14</xref>) se consideran nulas.</p><p id="P55">La etapa de mantenimiento se habilita cuando el objetivo se ha logrado y se ha mantenido al menos <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> &#x02212; 2 veces durante los &#x000fa;ltimos <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> d&#x000ed;as. El objetivo se considera alcanzado cuando la diferencia entre los pasos reales y la referencia se encuentra dentro de una tolerancia predefinida <italic toggle="yes">tol</italic><sub><italic toggle="yes">4</italic></sub>. Una nueva variable logica auxiliar <italic toggle="yes">&#x003b4;</italic><sub><italic toggle="yes">goal</italic></sub>(<italic toggle="yes">k</italic>), que no est&#x000e1; incluida en la intervenci&#x000f3;n general de HMPC por (<xref rid="FD11" ref-type="disp-formula">11</xref>)-(<xref rid="FD13" ref-type="disp-formula">13</xref>), se define como
<disp-formula id="FD32">
<label>(32)</label>
<mml:math id="M55" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mtext mathvariant="italic">goal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x021d4;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
</disp-formula>
Por tanto, la segunda fase se activa en el tiempo de muestreo <italic toggle="yes">k</italic> si
<disp-formula id="FD33">
<label>(33)</label>
<mml:math id="M56" display="block"><mml:mrow><mml:munderover><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mtext mathvariant="italic">goal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math>
</disp-formula>
Durante esta fase es necesario reconfigurar el controlador para apuntar a un uso bajo de puntos (<italic toggle="yes">u</italic><sub>9</sub>). Si las entradas de destino son: <italic toggle="yes">u</italic><sub><italic toggle="yes">r</italic></sub> = [<italic toggle="yes">u</italic><sub><italic toggle="yes">r</italic>8</sub>
<italic toggle="yes">u</italic><sub><italic toggle="yes">r</italic>9</sub>]<sup><italic toggle="yes">T</italic></sup>, se debe seleccionar un valor apropiado para <italic toggle="yes">ur</italic><sub>9</sub> (por ejemplo, <italic toggle="yes">ur</italic><sub>9</sub> = 0 puntos) y la matriz de peso de entrada se cambia a <inline-formula><mml:math id="M57" display="inline"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. El valor de <inline-formula><mml:math id="M58" display="inline"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> depende del rendimiento esperado del seguimiento del punto de ajuste frente al objetivo de entrada. Si en alg&#x000fa;n momento <italic toggle="yes">k</italic> no cumple con la conditi&#x000f3;n especificada en la ecuaci&#x000f3;n (<xref rid="FD33" ref-type="disp-formula">33</xref>) (por ejemplo, una reca&#x000ed;da), se reactiva la fase de inicio.</p><p id="P56">Cabe resaltar que se ha utilizado la formulaci&#x000f3;n completa del enfoque HMPC establecido en (<xref rid="R29" ref-type="bibr">Nandola and Rivera, 2013</xref>); sin embargo, la configuraci&#x000f3;n de valores de par&#x000e1;metros y de las diferentes matrices de peso, se ha adaptado a las necesidades espec&#x000ed;ficas de la intervenci&#x000f3;n comportamental.</p></sec></sec><sec id="S13"><label>5.</label><title>Resultados de la simulaci&#x000f3;n de lazo cerrado</title><p id="P57">En esta secci&#x000f3;n, se presentan los resultados de la simulaci&#x000f3;n de lazo cerrado que se basan en el modelo ARX estimado descrito en la <xref rid="F3" ref-type="fig">Figura 3</xref>. La intervenci&#x000f3;n comienza en el d&#x000ed;a cero con el objetivo de cambiar el estilo de vida sedentario del participante, rendimiento promedio de 5,000 pasos/d&#x000ed;a, a un estilo de vida m&#x000e1;s activo con un promedio de 10,000 pasos/d&#x000ed;a. Este escenario de simulaci&#x000f3;n est&#x000e1; inspirado en el rendimiento observado en intervenciones previas de actividad f&#x000ed;sica con componentes similares (<xref rid="R16" ref-type="bibr">King et al., 2013</xref>). El modelo ARX regularizado estimado a partir de los datos experimentales de <italic toggle="yes">Just Walk</italic> est&#x000e1; impl&#x000ed;cito como modelo de controlador para el HMPC con <italic toggle="yes">Metas</italic> (<italic toggle="yes">u</italic><sub>8</sub>), y <italic toggle="yes">Puntos esperados</italic> (<italic toggle="yes">u</italic><sub>9</sub>) como las variables manipuladas. Para minimizar la posibilidad de que los participantes se vuelvan dependientes de las recompensas econ&#x000f3;micas, la se&#x000f1;al de <italic toggle="yes">Puntos concedidos</italic> (<italic toggle="yes">u</italic><sub>10</sub>) se considera una perturbacion medida. Otra perturbaci&#x000f3;n importante considerada en este caso es <italic toggle="yes">Contexto ambiental: temperatura</italic>
<inline-formula><mml:math id="M59" display="inline"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:msub><mml:mn>7</mml:mn><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; las desviaciones de la temperatura media pueden tener un impacto significativo en <italic toggle="yes">Comportamiento</italic> (<italic toggle="yes">y</italic><sub>4</sub>). Adem&#x000e1;s, dada su importancia, el modelo del sistema se ha aumentado para incluir <italic toggle="yes">Logro de metas</italic> (<italic toggle="yes">y</italic><sub>7</sub>) como salida del sistema, lo que permite la aplicaci&#x000f3;n de restricciones en esta se&#x000f1;al (<xref rid="R8" ref-type="bibr">El Mistiri et al., 2022</xref>).</p><p id="P58">Los par&#x000e1;metros para el HMPC son los siguientes: el tiempo de muestreo <italic toggle="yes">T</italic><sub><italic toggle="yes">s</italic></sub> = 1 d&#x000ed;a, el horizonte de predicci&#x000f3;n <italic toggle="yes">p</italic> = 20 d&#x000ed;as y el horizonte de movimiento <italic toggle="yes">m</italic> = 7 d&#x000ed;as. Los l&#x000ed;mites m&#x000ed;nimo y m&#x000e1;ximo para las variables manipuladas son <italic toggle="yes">u</italic><sub><italic toggle="yes">min</italic></sub> = [5000 0]<sup><italic toggle="yes">T</italic></sup>, <italic toggle="yes">u</italic><sub><italic toggle="yes">max</italic></sub> = [10000 500]<sup><italic toggle="yes">T</italic></sup>, &#x00394;<italic toggle="yes">u</italic><sub><italic toggle="yes">min</italic></sub> = [&#x02212;1000 &#x02013; 500]<sup><italic toggle="yes">T</italic></sup>, &#x00394;<italic toggle="yes">u</italic><sub><italic toggle="yes">max</italic></sub> = [1000 100]<sup><italic toggle="yes">T</italic></sup>. Las restricciones de salida son <italic toggle="yes">y</italic><sub><italic toggle="yes">min</italic></sub> = [0 &#x02013; 100]<sup><italic toggle="yes">T</italic></sup>, <italic toggle="yes">y</italic><sub><italic toggle="yes">max</italic></sub> = [&#x0221e; &#x0221e;]<sup><italic toggle="yes">T</italic></sup>. La matriz de pesos para supresi&#x000f3;n de movimientos de entrada <italic toggle="yes">Q</italic>&#x00394;<sub><italic toggle="yes">u</italic></sub>, y la matriz de pesos de variables manipuladas <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>, se definen en las ecuaciones (<xref rid="FD34" ref-type="disp-formula">34</xref>) y (<xref rid="FD35" ref-type="disp-formula">35</xref>) respectivamente.
<disp-formula id="FD34">
<label>(34)</label>
<mml:math id="M60" display="block"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>01</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD35">
<label>(35)</label>
<mml:math id="M61" display="block"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
Un punto de referencia objetivo para <italic toggle="yes">Puntos Esperados</italic> (<italic toggle="yes">u</italic><sub>9</sub>) se establece en 0 puntos / d&#x000ed;a, que se persigue a trav&#x000e9;s del peso asignado en <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>. Este peso se incrementa en la fase de mantenimiento, por lo que el objetivo de 0 puntos / d&#x000ed;a para <italic toggle="yes">u</italic><sub>9</sub> tiene una prioridad m&#x000e1;s alta. Los valores categ&#x000f3;ricos de los componentes de la intervenci&#x000f3;n est&#x000e1;n definidos por los conjuntos <italic toggle="yes">U</italic><sub>8</sub> = {5000, 6000, 7000, 8000, 9000, 10000}, y <italic toggle="yes">U</italic><sub>9</sub>)(<italic toggle="yes">k</italic>) = {100, 200, 300, 400, 500} con <inline-formula><mml:math id="M62" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> y <inline-formula><mml:math id="M63" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. La perturbaci&#x000f3;n no medida se asume gaussiana con <inline-formula><mml:math id="M64" display="inline"><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>400</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> adem&#x000e1;s, no se considera ning&#x000fa;n desajuste de modelo de planta. Para permitir un aumento progresivo de los pasos realizados y un r&#x000e1;pido rechazo de perturbaciones, los par&#x000e1;metros de ajuste son <italic toggle="yes">&#x003b1;</italic><sub><italic toggle="yes">r</italic></sub> = [0,9 0]<sup><italic toggle="yes">T</italic></sup>, <italic toggle="yes">&#x003b1;</italic><sub><italic toggle="yes">d</italic></sub> = [0,2 0,99]<sup><italic toggle="yes">T</italic></sup>, <italic toggle="yes">f</italic><sub><italic toggle="yes">a</italic></sub> = [0,3 0]<sup><italic toggle="yes">T</italic></sup>. Para la ejecuci&#x000f3;n del algoritmo de optimizaci&#x000f3;n HMPC se utiliza MATLAB<sup>&#x000ae;</sup> junto con el paquete de software IBM ILOG CPLEX<sup>&#x000ae;</sup> 12.10.</p><p id="P59">Para encontrar los par&#x000e1;metros anteriores ha sido necesario evaluar distintos valores de las matrices de pesos, las restricciones del problema, y los par&#x000e1;metros de sintonizaci&#x000f3;n del controlador. Las restricciones se definen principalmente para corresponder a un ejemplo t&#x000ed;pico de lo que ser&#x000ed;a una intervenci&#x000f3;n implementada en un participante en el campo, y son consistentes con ejemplos presentados en (<xref rid="R25" ref-type="bibr">Mart&#x000ed;n et al., 2016</xref>; <xref rid="R21" ref-type="bibr">Mart&#x000ed;n, 2016</xref>). La sintonizaci&#x000f3;n del controlador emplea distintas facetas. Principalmente est&#x000e1;n los valores de los filtros explicados en las ecuaciones (<xref rid="FD19" ref-type="disp-formula">19</xref>)-(<xref rid="FD23" ref-type="disp-formula">23</xref>) que corresponden a valores de sistemas discretos que se pueden relacionar claramente con constantes de tiempo. El valor de <italic toggle="yes">&#x003b1;</italic><sub><italic toggle="yes">r</italic></sub> = [0,9 0]<sup><italic toggle="yes">T</italic></sup> corresponde a una constante de tiempo de 9,5 d&#x000ed;as en la respuesta de comportamiento, y se refleja en un tiempo de asentamiento de aproximadamente 30 d&#x000ed;as en la primera etapa de la intervenci&#x000f3;n. La definici&#x000f3;n de <italic toggle="yes">&#x003b1;</italic><sub><italic toggle="yes">d</italic></sub> = [0,2 0,99]<sup><italic toggle="yes">T</italic></sup> refleja el objetivo que el controlador responda &#x000e1;gilmente a cambios de temperatura, pero demuestre menor sensitividad a los puntos otorgados. El valor de <italic toggle="yes">f</italic><sub><italic toggle="yes">a</italic></sub> = 0,3 favorece un rechazo veloz de las perturbaciones inmedibles. Con respecto a las matrices de peso, se usa un valor peque&#x000f1;o de <italic toggle="yes">Q</italic><sub>&#x00394;<italic toggle="yes">u</italic></sub> para evitar oscilaciones en la respuesta. As&#x000ed; mismo, se utiliza un valor de <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>(2, 2) = 0,5 (con punto de consigna de cero) para reducir la dependencia del controlador en el uso de puntos otorgados; este peso se aumenta a <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>(2, 2) = 1 durante la fase de mantenimiento.</p><p id="P60">Los resultados de la simulaci&#x000f3;n se muestran en la <xref rid="F7" ref-type="fig">Figura 7</xref> donde <italic toggle="yes">Metas</italic> (<italic toggle="yes">u</italic><sub>8</sub>), y <italic toggle="yes">Puntos Esperados</italic> (<italic toggle="yes">u</italic><sub>9</sub>) son generados por el algoritmo HMPC en una configuraci&#x000f3;n de intervenci&#x000f3;n adaptativa. Como se explic&#x000f3; anteriormente, <italic toggle="yes">Puntos Concedidos</italic> son iguales a <italic toggle="yes">Puntos Esperados</italic> solo cuando se cumplen las metas diarias. La reconfiguraci&#x000f3;n del controlador se realiza en la etapa de mantenimiento de la intervenci&#x000f3;n, ilustrada por regiones sombreadas (en verde); esta fase se activa cuando se alcanza el punto de ajuste de 10,000 pasos/d&#x000ed;a durante al menos 4 d&#x000ed;as dentro de los &#x000fa;ltimos <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> = 6 d&#x000ed;as, con una tolerancia de <italic toggle="yes">tol</italic><sub>4</sub> = 700 pasos/d&#x000ed;a. Durante la fase de mantenimiento se aplica una reducci&#x000f3;n en la cantidad de puntos esperados y otorgados mediante el ajuste de la matriz de peso variable manipulada a <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub> = diag(0, 1). El impacto de las perturbaciones medidas, en forma de <italic toggle="yes">Contexto ambiental: temperatura</italic> se eval&#x000fa;a en la simulaci&#x000f3;n con un pulso negativo a partir del d&#x000ed;a 60 y con una duraci&#x000f3;n de 15 d&#x000ed;as; como resultado, el conteo de pasos del participante disminuye fuera de la regi&#x000f3;n de tolerancia y el controlador reacciona desactivando la fase de mantenimiento, volviendo a activar la fase de intervenci&#x000f3;n principal, reduciendo la meta diaria para evitar una ca&#x000ed;da significativa en <italic toggle="yes">Logro de la meta</italic> (<italic toggle="yes">y</italic><sub>7</sub>; mostrado en la <xref rid="F8" ref-type="fig">Figura 8</xref>).</p><p id="P61">Los resultados de la <xref rid="F7" ref-type="fig">Figura 7</xref> ilustran la eficacia de HMPC en la gesti&#x000f3;n de intervenciones comportamentales personalizadas. Primero, el comportamiento deseado (en pasos / d&#x000ed;a) se logra dentro de los 30 d&#x000ed;as a partir de la puesta en servicio del controlador con solo una violati&#x000f3;n infrecuente de la restricci&#x000f3;n de logro de la meta. Al comparar los resultados de la simulaci&#x000f3;n de lazo cerrado con el conocimiento de la din&#x000e1;mica de la planta en la <xref rid="F6" ref-type="fig">Figura 6</xref>, est&#x000e1; claro que debido a que la ganancia de <italic toggle="yes">Metas</italic> a <italic toggle="yes">Comportamiento</italic> es menor que 1, se necesita un valor sostenido de <italic toggle="yes">Puntos Esperados</italic> para que este participante alcance el punto de ajuste. Como resultado, <italic toggle="yes">Puntos Esperados</italic> permanece en un valor de 200 puntos / d&#x000ed;a durante una gran parte de la intervenci&#x000f3;n, a pesar de un objetivo variable manipulado de 0 puntos por d&#x000ed;a y un peso distinto de cero en <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub> (configuraci&#x000f3;n destinada a desalentar dependencia financiera). Desde el punto de vista del cambio de comportamiento, a medida que los participantes sigan involucrados en la intervenci&#x000f3;n, los resultados positivos de un comportamiento saludable deber&#x000ed;an aumentar (y mantener) la actividad. Esto destaca la necesidad de datos y modelos m&#x000e1;s sofisticados para describir din&#x000e1;micas complejas asociadas con el cambio de comportamiento; este efecto podr&#x000ed;a capturarse en el modelo TCS a trav&#x000e9;s de interacciones con construcciones comportamentales como <italic toggle="yes">Resultados de comportamiento</italic> (que result&#x000f3; ser dif&#x000ed;cil de medir de manera confiable en <italic toggle="yes">Just Walk</italic>) o mediante la construcci&#x000f3;n de modelos de simulaci&#x000f3;n m&#x000e1;s sofisticados que incorporen un comportamiento no lineal anticipado.</p><p id="P62">Como consecuencia de algunas especificaciones r&#x000ed;gidas para la intervenci&#x000f3;n (por ejemplo, uso m&#x000ed;nimo de los puntos esperados, conjuntos categ&#x000f3;ricos para los puntos y metas esperados y un l&#x000ed;mite bajo en el logro de la meta), es dif&#x000ed;cil alcanzar una soluci&#x000f3;n &#x000f3;ptima que cumpla con todos los requisitos. La <xref rid="F8" ref-type="fig">Figura 8</xref> muestra el desempe&#x000f1;o del controlador en lo que respecta al rechazo de perturbaciones no medidas y la restricci&#x000f3;n del logro de metas. La restricci&#x000f3;n de salida sobre el logro de la meta se viola en mu&#x000ed;ltiples ocasiones, que corresponden a las mayores magnitudes en la perturbaci&#x000f3;n no medida, como se ve en la <xref rid="F8" ref-type="fig">Figura 8</xref>. Un medio para mejorar el rendimiento del controlador con respecto a la satisfacci&#x000f3;n de la restricci&#x000f3;n de logro de la meta es hacer que las variables manipuladas sean continuas y menos dependientes de los valores definidos por las categor&#x000ed;as; esto sigue de acuerdo con <xref rid="R8" ref-type="bibr">El Mistiri et al. (2022)</xref>.</p></sec><sec id="S14"><label>6.</label><title>Conclusiones</title><p id="P63">En este trabajo se propone una intervenci&#x000f3;n de HPMC para dise&#x000f1;ar una intervenci&#x000f3;n de actividad f&#x000ed;sica comportamental. A medida que avanza la intervenci&#x000f3;n, el individuo ganar&#x000e1; confianza y, por lo tanto, los puntos de recompensa se reducen y eventualmente es posible que se eliminen totalmente. Esta caracter&#x000ed;stica se represent&#x000f3; de manera efectiva a trav&#x000e9;s de la reconfiguraci&#x000f3;n del controlador lograda mediante el uso de pesos de penalizaci&#x000f3;n en los puntos para desalentar su uso. Durante esta etapa de mantenimiento, el comportamiento objetivo se logra mediante mejoras en el <italic toggle="yes">logro de metas</italic> y aumento en la <italic toggle="yes">autoeficacia</italic> del participante, lo que facilita el uso de menos puntos.</p><p id="P64">Se present&#x000f3; en este trabajo una simulaci&#x000f3;n en lazo cerrado basada en un modelo obtenido de un participante representativo de la intervenci&#x000f3;n <italic toggle="yes">Just Walk</italic>. El m&#x000e9;todo de identificaci&#x000f3;n envuelve una se&#x000f1;al multiseno con un modelo ARX de cuatro entradas obtenido por regularizaci&#x000f3;n. Los resultados de la simulaci&#x000f3;n demuestran un buen rendimiento del algoritmo HMPC, con un seguimiento estricto del punto de ajuste y un rechazo aceptable de perturbaciones. Cuando se logra el objetivo, el sistema puede mantener el comportamiento incluso con la reducci&#x000f3;n de puntos impuesta por la etapa de mantenimiento. En presencia de alteraciones importantes y / o reca&#x000ed;das, se reactiva la fase de entrenamiento de iniciaci&#x000f3;n comportamental.</p><p id="P65">Este trabajo forma parte de una serie de aplicaciones innovadoras de conceptos de ingenier&#x000ed;a de control e identificaci&#x000f3;n de sistemas que inicialmente se llevaron a cabo como parte de la intervenci&#x000f3;n <italic toggle="yes">Just Walk</italic> en la Universidad Estatal de Arizona (ASU) (<xref rid="R22" ref-type="bibr">Mart&#x000ed;n et al., 2015a</xref>,<xref rid="R24" ref-type="bibr">c</xref>; <xref rid="R12" ref-type="bibr">Hekler, 2015</xref>) y que ahora son parte de la intervenci&#x000f3;n <italic toggle="yes">YourMove</italic>, una colaboraci&#x000f3;n de la Universidad de California en San Diego y ASU (<xref rid="R13" ref-type="bibr">Hekler and Rivera, 2021</xref>). El objetivo principal es incluir esta intervenci&#x000f3;n en el dise&#x000f1;o de una intervenci&#x000f3;n de salud comportamental a largo plazo que incluya fases de identificaci&#x000f3;n, inicio y mantenimiento, vinculado con una metodolog&#x000ed;a de identificaci&#x000f3;n en lo que designamos como el <italic toggle="yes">Control Optimization Trial</italic> (<xref rid="R14" ref-type="bibr">Hekler et al., 2018</xref>).</p></sec></body><back><ack id="S15"><title>Agradecimientos</title><p id="P66">El apoyo para este trabajo ha sido proporcionado por la Fundaci&#x000f3;n Nacional de Ciencias (NSF por sus siglas en ingle&#x000ed;s) a trav&#x000e9;s de la subvenci&#x000f3;n IIS-1449751, y el Instituto Nacional de la Salud (NIH por sus siglas en ingl&#x000e9;s) a trav&#x000e9;s de la subvenci&#x000f3;n R01CA244777. Las opiniones expresadas en este art&#x000ed;culo son de los autores y no reflejan necesariamente los puntos de vista de NSF o NIH.</p></ack><ref-list><title>Referencias</title><ref id="R1"><mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>MA</given-names></name>, <name><surname>Sallis</surname><given-names>JF</given-names></name>, <name><surname>Norman</surname><given-names>GJ</given-names></name>, <name><surname>Hovell</surname><given-names>MF</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <name><surname>Perata</surname><given-names>E</given-names></name>, <year>2013</year>. <article-title>An adaptive physical activity intervention for overweight adults: A randomized controlled trial</article-title>. <source>PloS one</source>
<volume>8</volume> (<issue>12</issue>), <fpage>e82901</fpage>.<pub-id pub-id-type="pmid">24349392</pub-id></mixed-citation></ref><ref id="R2"><mixed-citation publication-type="journal"><name><surname>Bandura</surname><given-names>A</given-names></name>, <year>1986</year>. <article-title>Social Foundations of Thought and Action: A Social Cognitive Theory</article-title>. <source>Prentice-Hall series in social learning theory</source>.</mixed-citation></ref><ref id="R3"><mixed-citation publication-type="book"><name><surname>Carver</surname><given-names>CS</given-names></name>, <name><surname>Scheier</surname><given-names>MF</given-names></name>, <year>1998</year>. <source>On the Self Regulation of Behavior</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref><ref id="R4"><mixed-citation publication-type="confproc"><name><surname>Chen</surname><given-names>T</given-names></name>, <name><surname>Ohlsson</surname><given-names>H</given-names></name>, <name><surname>Goodwin</surname><given-names>GC</given-names></name>, <name><surname>Ljung</surname><given-names>L</given-names></name>, <year>2011</year>. <article-title>Kernel selection in linear system identification part ii: A classical perspective</article-title>. In: <conf-name>2011 50th IEEE Conference on Decision and Control and European Control Conference</conf-name>. <publisher-name>IEEE</publisher-name>, pp. <fpage>4326</fpage>&#x02013;<lpage>4331</lpage>.</mixed-citation></ref><ref id="R5"><mixed-citation publication-type="journal"><name><surname>Clague</surname><given-names>J</given-names></name>, <name><surname>Bernstein</surname><given-names>L</given-names></name>, <year>2012</year>. <article-title>Physical activity and cancer</article-title>. <source>Current Oncology Reports</source>
<volume>14</volume> (<issue>6</issue>), <fpage>550</fpage>&#x02013;<lpage>558</lpage>.<pub-id pub-id-type="pmid">22945451</pub-id></mixed-citation></ref><ref id="R6"><mixed-citation publication-type="journal"><name><surname>Deshpande</surname><given-names>S</given-names></name>, <name><surname>Nandola</surname><given-names>NN</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Younger</surname><given-names>JW</given-names></name>, <year>2014</year>. <article-title>Optimized treatment of fibromyalgia using system identification and hybrid model predictive control</article-title>. <source>Control Engineering Practice</source>
<volume>33</volume> (<issue>1</issue>), <fpage>161</fpage>&#x02013;<lpage>173</lpage>.<pub-id pub-id-type="pmid">25506132</pub-id></mixed-citation></ref><ref id="R7"><mixed-citation publication-type="journal"><name><surname>Dong</surname><given-names>Y</given-names></name>, <name><surname>Deshpande</surname><given-names>S</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Downs</surname><given-names>DS</given-names></name>, <name><surname>Savage</surname><given-names>JS</given-names></name>, <year>2014</year>. <article-title>Hybrid model predictive control for sequential decision policies in adaptive behavioral interventions</article-title>. In: <source>Proc. ACC</source> pp. <fpage>4198</fpage>&#x02013;<lpage>4203</lpage>.</mixed-citation></ref><ref id="R8"><mixed-citation publication-type="journal"><name><surname>El Mistiri</surname><given-names>M</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Klasnja</surname><given-names>P</given-names></name>, <name><surname>Park</surname><given-names>J</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2022</year>. <article-title>Model predictive control strategies for optimized mhealth interventions for physical activity</article-title>. In: <source>2022 American Control Conference (ACC)</source>. p. <comment>in press.</comment></mixed-citation></ref><ref id="R9"><mixed-citation publication-type="book"><name><surname>Ferster</surname><given-names>CB</given-names></name>, <year>1970</year>. <part-title>Schedules of reinforcement with Skinner</part-title>. In: <name><surname>Dews</surname><given-names>PB</given-names></name> (Ed.), <source>Festschrift for B. F. Skinner. Century psychology series</source>. <publisher-loc>New York</publisher-loc>, <publisher-name>Appleton-Century-Crofts</publisher-name>, pp. <fpage>37</fpage>&#x02013;<lpage>46</lpage>.</mixed-citation></ref><ref id="R10"><mixed-citation publication-type="journal"><name><surname>Freigoun</surname><given-names>MT</given-names></name>, <name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Magann</surname><given-names>AB</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Phatak</surname><given-names>SS</given-names></name>, <name><surname>Korinek</surname><given-names>EV</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2017</year>. <article-title>System identification of just walk: A behavioral mhealth intervention for promoting physical activity</article-title>. In: <source>2017 American Control Conference (ACC)</source>. pp. <fpage>116</fpage>&#x02013;<lpage>121</lpage>.</mixed-citation></ref><ref id="R11"><mixed-citation publication-type="journal"><name><surname>Guillaume</surname><given-names>P</given-names></name>, <name><surname>Schoukens</surname><given-names>J</given-names></name>, <name><surname>Pintelon</surname><given-names>R</given-names></name>, <name><surname>Kollar</surname><given-names>I</given-names></name>, <year>1991</year>. <article-title>Crest-factor minimization using nonlinear Chebyshev approximation methods</article-title>. <source>IEEE Transactions on Instrumentation and Measurement</source>
<volume>40</volume> (<issue>6</issue>), <fpage>982</fpage>&#x02013;<lpage>989</lpage>.</mixed-citation></ref><ref id="R12"><mixed-citation publication-type="webpage"><name><surname>Hekler</surname><given-names>E</given-names></name>, <year>2015</year>. <source><italic toggle="yes">Just Walk</italic> Study</source>. <comment><ext-link xlink:href="http://justwalkstudy.weebly.com/" ext-link-type="uri">http://justwalkstudy.weebly.com/</ext-link></comment>, [<comment>Online; accessed</comment>
<date-in-citation>September-23-2015</date-in-citation>].</mixed-citation></ref><ref id="R13"><mixed-citation publication-type="book"><name><surname>Hekler</surname><given-names>E</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <year>2021</year>. <source>Optimizing individualized and adaptive mhealth interventions via control systems engineering methods</source>, <comment>R01CA244777</comment>: <publisher-name>National Institute of Health, National Cancer Institute</publisher-name>.</mixed-citation></ref><ref id="R14"><mixed-citation publication-type="journal"><name><surname>Hekler</surname><given-names>EB</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Martin</surname><given-names>CA</given-names></name>, <name><surname>Phatak</surname><given-names>SS</given-names></name>, <name><surname>Freigoun</surname><given-names>MT</given-names></name>, <name><surname>Korinek</surname><given-names>E</given-names></name>, <name><surname>Klasnja</surname><given-names>P</given-names></name>, <name><surname>Adams</surname><given-names>MA</given-names></name>, <name><surname>Buman</surname><given-names>MP</given-names></name>, <year>2018</year>. <article-title>Tutorial for using control systems engineering to optimize adaptive mobile health interventions</article-title>. <source>Journal of medical Internet research</source>
<volume>20</volume> (<issue>6</issue>), <fpage>e8622</fpage>. DOI: <pub-id pub-id-type="doi">10.2196/jmir.8622</pub-id></mixed-citation></ref><ref id="R15"><mixed-citation publication-type="journal"><name><surname>Kha</surname><given-names>R</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Klasjna</surname><given-names>P</given-names></name>, <name><surname>Hekler</surname><given-names>E</given-names></name>, <year>2022</year>. <article-title>Model personalization in behavioral interventions using Model-on-Demand estimation and discrete simultaneous perturbation stochastic approximation</article-title>. In: <source>2022 American Control Conference (ACC)</source>. p. <comment>submitted.</comment></mixed-citation></ref><ref id="R16"><mixed-citation publication-type="journal"><name><surname>King</surname><given-names>AC</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <name><surname>Grieco</surname><given-names>LA</given-names></name>, <name><surname>Winter</surname><given-names>SJ</given-names></name>, <name><surname>Sheats</surname><given-names>JL</given-names></name>, <name><surname>Buman</surname><given-names>MP</given-names></name>, <name><surname>Banerjee</surname><given-names>B</given-names></name>, <name><surname>Robinson</surname><given-names>TN</given-names></name>, <name><surname>Cirimele</surname><given-names>J</given-names></name>, <year>2013</year>. <article-title>Harnessing different motivational frames via mobile phones to promote daily physical activity and reduce sedentary behavior in aging adults</article-title>. <source>PLoS ONE</source>
<volume>8</volume> (<issue>4</issue>), <fpage>e62613</fpage>.<pub-id pub-id-type="pmid">23638127</pub-id></mixed-citation></ref><ref id="R17"><mixed-citation publication-type="journal"><name><surname>Korinek</surname><given-names>EV</given-names></name>, <name><surname>Phatak</surname><given-names>SS</given-names></name>, <name><surname>Martin</surname><given-names>CA</given-names></name>, <name><surname>Freigoun</surname><given-names>MT</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Adams</surname><given-names>MA</given-names></name>, <name><surname>Klasnja</surname><given-names>P</given-names></name>, <name><surname>Buman</surname><given-names>MP</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2018</year>. <article-title>Adaptive step goals and rewards: a longitudinal growth model of daily steps for a smartphone-based walking intervention</article-title>. <source>Journal of behavioral medicine</source>
<volume>41</volume> (<issue>1</issue>), <fpage>74</fpage>&#x02013;<lpage>86</lpage>.<pub-id pub-id-type="pmid">28918547</pub-id></mixed-citation></ref><ref id="R18"><mixed-citation publication-type="confproc"><name><surname>Ljung</surname><given-names>L</given-names></name>, <month>Mar</month>
<year>1994</year>. <article-title>From Data to Model: A Guided Tour</article-title>. In: <conf-name>International IEE Conference on Control</conf-name>. <conf-loc>Warwick, England</conf-loc>, pp. <fpage>422</fpage>&#x02013;<lpage>430</lpage>.</mixed-citation></ref><ref id="R19"><mixed-citation publication-type="book"><name><surname>Ljung</surname><given-names>L</given-names></name>, <year>1999</year>. <source>System Identification: Theory for the User</source>, <edition>2nd Edition</edition>. <publisher-loc>Upper Saddle River, NJ</publisher-loc>: <publisher-name>Prentice Hall PTR</publisher-name>.</mixed-citation></ref><ref id="R20"><mixed-citation publication-type="confproc"><name><surname>Ljung</surname><given-names>L</given-names></name>, <name><surname>Singh</surname><given-names>R</given-names></name>, <name><surname>Chen</surname><given-names>T</given-names></name>, <year>2015</year>. <article-title>Regularization features in the system identification toolbox</article-title>. <source>IFAC-PapersOnLine</source>
<volume>48</volume> (<issue>28</issue>), <fpage>745</fpage>&#x02013;<lpage>750</lpage>, <conf-name>17th IFAC Symposium on System Identification SYSID 2015</conf-name>.</mixed-citation></ref><ref id="R21"><mixed-citation publication-type="thesis"><name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <year>2016</year>. <source>A system identification and control engineering approach for optimizing mhealth behavioral interventions based on social cognitive theory</source>. <comment>Ph.D. thesis, Electrical Engineering, Arizona State University.</comment></mixed-citation></ref><ref id="R22"><mixed-citation publication-type="journal"><name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Deshpande</surname><given-names>S</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <year>2015a</year>. <article-title>A system identification approach for improving behavioral interventions based on Social Cognitive Theory</article-title>. In: <source>Proc. ACC</source> pp. <fpage>5878</fpage>&#x02013;<lpage>5883</lpage>.</mixed-citation></ref><ref id="R23"><mixed-citation publication-type="confproc"><name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2015b</year>. <article-title>Design of informative identification experiments for behavioral interventions</article-title>. In: <conf-name>Proceedings of the 17th IFAC Symposium on System Identification</conf-name>. pp. <fpage>1325</fpage>&#x02013;<lpage>1330</lpage>.</mixed-citation></ref><ref id="R24"><mixed-citation publication-type="confproc"><name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2015c</year>. <article-title>An identification test monitoring procedure for MIMO systems based on statistical uncertainty estimation</article-title>. In: <conf-name>Proc. 54th IEEE CDC</conf-name>. pp. <fpage>2719</fpage>&#x02013;<lpage>2724</lpage>.</mixed-citation></ref><ref id="R25"><mixed-citation publication-type="confproc"><name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2016</year>. <article-title>A decision framework for an adaptive behavioral intervention for physical activity using hybrid model predictive control</article-title>. In: <conf-name>Proceedings of the American Control Conference</conf-name>. pp. <fpage>3576</fpage>&#x02013;<lpage>3581</lpage>.</mixed-citation></ref><ref id="R26"><mixed-citation publication-type="journal"><name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <name><surname>Riley</surname><given-names>WT</given-names></name>, <name><surname>Buman</surname><given-names>MP</given-names></name>, <name><surname>Adams</surname><given-names>MA</given-names></name>, <name><surname>Magann</surname><given-names>AB</given-names></name>, <year>2020</year>. <article-title>Development of a control-oriented model of Social Cognitive Theory for optimized mHealth behavioral interventions</article-title>. <source>IEEE Transactions on Control Systems Technology</source>
<volume>28</volume> (<issue>2</issue>), <fpage>331</fpage>&#x02013;<lpage>346</lpage>.<pub-id pub-id-type="pmid">33746479</pub-id></mixed-citation></ref><ref id="R27"><mixed-citation publication-type="journal"><name><surname>McGinnis</surname><given-names>JM</given-names></name>, <name><surname>Williams-Russo</surname><given-names>P</given-names></name>, <name><surname>Knickman</surname><given-names>JR</given-names></name>, <year>2002</year>. <article-title>The case for more active policy attention to health promotion</article-title>. <source>Health Affairs</source>
<volume>21</volume> (<issue>2</issue>), <fpage>78</fpage>&#x02013;<lpage>93</lpage>.</mixed-citation></ref><ref id="R28"><mixed-citation publication-type="book"><name><surname>Morari</surname><given-names>M</given-names></name>, <name><surname>Zafiriou</surname><given-names>E</given-names></name>, <year>1989</year>. <source>Robust Process Control</source>. <publisher-name>Prentice-Hall International</publisher-name>.</mixed-citation></ref><ref id="R29"><mixed-citation publication-type="journal"><name><surname>Nandola</surname><given-names>NN</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <year>2013</year>. <article-title>An improved formulation of hybrid model predictive control with application to production-inventory systems</article-title>. <source>IEEE Trans. on Control Systems Technology</source>
<volume>21</volume> (<issue>1</issue>), <fpage>121</fpage>&#x02013;<lpage>135</lpage>.</mixed-citation></ref><ref id="R30"><mixed-citation publication-type="journal"><name><surname>Navarro-Barrientos</surname><given-names>JE</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Collins</surname><given-names>LM</given-names></name>, <year>2011</year>. <article-title>A dynamical model for describing behavioural interventions for weight loss and body composition change</article-title>. <source>Mathematical and Computer Modelling of Dynamical Systems</source>
<volume>17</volume> (<issue>2</issue>), <fpage>183</fpage>&#x02013;<lpage>203</lpage>.<pub-id pub-id-type="pmid">21673826</pub-id></mixed-citation></ref><ref id="R31"><mixed-citation publication-type="journal"><name><surname>Payne</surname><given-names>HE</given-names></name>, <name><surname>Lister</surname><given-names>C</given-names></name>, <name><surname>West</surname><given-names>JH</given-names></name>, <name><surname>Bernhardt</surname><given-names>JM</given-names></name>, <year>2015</year>. <article-title>Behavioral functionality of mobile apps in health interventions: A systematic review of the literature</article-title>. <source>JMIR mHealth and uHealth</source>
<volume>3</volume> (<issue>1</issue>), <fpage>e20</fpage>.<pub-id pub-id-type="pmid">25803705</pub-id></mixed-citation></ref><ref id="R32"><mixed-citation publication-type="journal"><name><surname>Phatak</surname><given-names>SS</given-names></name>, <name><surname>Freigoun</surname><given-names>MT</given-names></name>, <name><surname>Mart&#x000ed;n</surname><given-names>CA</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Korinek</surname><given-names>EV</given-names></name>, <name><surname>Adams</surname><given-names>MA</given-names></name>, <name><surname>Buman</surname><given-names>MP</given-names></name>, <name><surname>Klasnja</surname><given-names>P</given-names></name>, <name><surname>Hekler</surname><given-names>EB</given-names></name>, <year>2018</year>. <article-title>Modeling individual differences: A case study of the application of system identification for personalizing a physical activity intervention</article-title>. <source>Journal of Biomedical Informatics</source>
<volume>79</volume>, <fpage>82</fpage>&#x02013;<lpage>97</lpage>.<pub-id pub-id-type="pmid">29409750</pub-id></mixed-citation></ref><ref id="R33"><mixed-citation publication-type="journal"><name><surname>Pillonetto</surname><given-names>G</given-names></name>, <name><surname>Dinuzzo</surname><given-names>F</given-names></name>, <name><surname>Chen</surname><given-names>T</given-names></name>, <name><surname>De Nicolao</surname><given-names>G</given-names></name>, <name><surname>Ljung</surname><given-names>L</given-names></name>, <year>2014</year>. <article-title>Kernel methods in system identification, machine learning and function estimation: A survey</article-title>. <source>Automatica</source>
<volume>50</volume> (<issue>3</issue>), <fpage>657</fpage>&#x02013;<lpage>682</lpage>.</mixed-citation></ref><ref id="R34"><mixed-citation publication-type="journal"><name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Lee</surname><given-names>H</given-names></name>, <name><surname>Mittelmann</surname><given-names>HD</given-names></name>, <name><surname>Braun</surname><given-names>MW</given-names></name>, <year>2009</year>. <article-title>Constrained multisine input signals for plant-friendly identification of chemical process systems</article-title>. <source>Journal of Process Control</source>
<volume>19</volume> (<issue>4</issue>), <fpage>623</fpage>&#x02013;<lpage>635</lpage>.</mixed-citation></ref><ref id="R35"><mixed-citation publication-type="journal"><name><surname>Shiffman</surname><given-names>S</given-names></name>, <name><surname>Stone</surname><given-names>AA</given-names></name>, <name><surname>Hufford</surname><given-names>MR</given-names></name>, <year>2008</year>. <article-title>Ecological momentary assessment</article-title>. <source>Clinical Psychology</source>
<volume>4</volume> (<issue>1</issue>), <fpage>1</fpage>&#x02013;<lpage>32</lpage>.</mixed-citation></ref><ref id="R36"><mixed-citation publication-type="journal"><name><surname>Timms</surname><given-names>KP</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Collins</surname><given-names>LM</given-names></name>, <name><surname>Piper</surname><given-names>ME</given-names></name>, <year>2014a</year>. <article-title>Continuous-time system identification of a smoking cessation intervention</article-title>,. <source>International Journal of Control</source>
<volume>87</volume> (<issue>7</issue>), <fpage>1423</fpage>&#x02013;<lpage>1437</lpage>.<pub-id pub-id-type="pmid">25382865</pub-id></mixed-citation></ref><ref id="R37"><mixed-citation publication-type="journal"><name><surname>Timms</surname><given-names>KP</given-names></name>, <name><surname>Rivera</surname><given-names>DE</given-names></name>, <name><surname>Piper</surname><given-names>ME</given-names></name>, <name><surname>Collins</surname><given-names>LM</given-names></name>, <year>2014b</year>. <article-title>A hybrid model predictive control strategy for optimizing a smoking cessation intervention</article-title>. In: <source>Proc. ACC</source> pp. <fpage>2389</fpage>&#x02013;<lpage>2394</lpage>.</mixed-citation></ref></ref-list></back><floats-group><fig position="float" id="F1"><label>Figura 1:</label><caption><p id="P67">Analog&#x000ed;a de fluidos para la versi&#x000f3;n simplificada del modelo TSC por (<xref rid="R26" ref-type="bibr">Mart&#x000ed;n et al., 2020</xref>) donde los insumos se representan como entradas y las salidas como niveles de inventario.</p></caption><graphic xlink:href="nihms-1804923-f0001" position="float"/></fig><fig position="float" id="F2"><label>Figura 2:</label><caption><p id="P68">Representaci&#x000f3;n conceptual de la intervenci&#x000f3;n adaptativa comportamental de lazo cerrado, basada en la versi&#x000f3;n simplificada del modelo TSC en la <xref rid="F1" ref-type="fig">Figura 1</xref></p></caption><graphic xlink:href="nihms-1804923-f0002" position="float"/></fig><fig position="float" id="F3"><label>Figura 3:</label><caption><p id="P69">Captura de pantalla de la aplicaci&#x000f3;n <italic toggle="yes">Just Walk</italic></p></caption><graphic xlink:href="nihms-1804923-f0003" position="float"/></fig><fig position="float" id="F4"><label>Figura 4:</label><caption><p id="P70">Representaci&#x000f3;n conceptual de un dise&#x000f1;o de espectros &#x0201c;con cremallera&#x0201d; para entradas de dise&#x000f1;o <italic toggle="yes">n</italic><sub><italic toggle="yes">u</italic></sub> = 2 design inputs, y <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> = 6 frecuencias arm&#x000f3;nicas.</p></caption><graphic xlink:href="nihms-1804923-f0004" position="float"/></fig><fig position="float" id="F5"><label>Figura 5:</label><caption><p id="P71">Gr&#x000e1;fico de series de tiempo de un participante seleccionado de <italic toggle="yes">Just Walk</italic> que muestra (desde arriba) cuatro secuencias de entrada correspondientes a variables manipuladas (<italic toggle="yes">Metas</italic> y <italic toggle="yes">Puntos esperados</italic>) y perturbaciones medidas (<italic toggle="yes">Puntos otorgados</italic> y <italic toggle="yes">Temperatura</italic>). El gr&#x000e1;fico inferior incluye el comportamiento previsto (pasos / d&#x000ed;a estimados a partir de un modelo ARX con regularizaci&#x000f3;n), el comportamiento real (en pasos / d&#x000ed;a) y las metas (en pasos / d&#x000ed;a). Las regiones de datos de estimaci&#x000f3;n y validaci&#x000f3;n se resaltan en cian y magenta, respectivamente. El ajuste general del NRMSE a los datos es del 48,74 % (con un ajuste del 37.03 % para la estimaci&#x000f3;n y un ajuste del 61.74 % para la validaci&#x000f3;n). El modelo ARX se estima mediante m&#x000ed;nimos cuadrados regularizados, con base en la estructura del modelo <italic toggle="yes">n</italic><sub><italic toggle="yes">a</italic></sub> = 2, <italic toggle="yes">n</italic><sub><italic toggle="yes">b</italic></sub> = [1 1 1 1], <italic toggle="yes">n</italic><sub><italic toggle="yes">k</italic></sub> = [1 1 1 1]. Los par&#x000e1;metros de regularizaci&#x000f3;n <italic toggle="yes">&#x003bb;</italic> and <italic toggle="yes">R</italic> se seleccionan en funci&#x000f3;n de la regularizaci&#x000f3;n del kernel sintonizada/Correlacionada (SC) (<xref rid="R33" ref-type="bibr">Pillonetto et al., 2014</xref>).</p></caption><graphic xlink:href="nihms-1804923-f0005" position="float"/></fig><fig position="float" id="F6"><label>Figura 6:</label><caption><p id="P72">Respuestas escalonadas del modelo de 4 entradas para un participante seleccionado.Las ganancias DC para cada entrada se resaltan en la parte superior de cada respuesta de paso.Las respuestas de pasos unitarios se organizan de izquierda a derecha como <italic toggle="yes">Temperatura</italic>, <italic toggle="yes">Metas</italic>, <italic toggle="yes">Puntos Esperados</italic>, and <italic toggle="yes">Puntos Concedidos</italic> con ganancias de 19.8, 0.625, 0.973, y &#x02212;3,41 &#x000d7; 10<sup>&#x02212;4</sup> respectivamente.</p></caption><graphic xlink:href="nihms-1804923-f0006" position="float"/></fig><fig position="float" id="F7"><label>Figura 7:</label><caption><p id="P73">La simulaci&#x000f3;n resulta de aplicar un controlador HMPC restringido en el modelo ARX estimado a partir de datos experimentales en presencia de perturbaciones medidas (desviaciones de la temperatura diaria promedio) y perturbaciones desconocidas no medidas. Los par&#x000e1;metros del controlador son: <italic toggle="yes">p</italic> = 20, <italic toggle="yes">m</italic> = 7, d&#x000ed;as <italic toggle="yes">Q</italic><sub><italic toggle="yes">y</italic></sub> = diag(1, 0), <italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>(2, 2) = 0,5 (<italic toggle="yes">Q</italic><sub><italic toggle="yes">u</italic></sub>(2, 2) = 1 en fase de mantenimiento), y <italic toggle="yes">Q</italic><sub>&#x00394;<italic toggle="yes">u</italic></sub> = diag(0, 0,01). Se aplican las siguientes restricciones: 0 &#x02264; <italic toggle="yes">u</italic><sub>8</sub> &#x02264; 10000 pasos/d&#x000ed;a, 0 &#x02264; <italic toggle="yes">u</italic><sub>9</sub> &#x02264; 500 puntos/d&#x000ed;a, &#x02212;500 &#x02264; &#x00394;<italic toggle="yes">u</italic><sub>9</sub> &#x02264; 100 puntos/d&#x000ed;a, y &#x02212;100 &#x02264; <italic toggle="yes">y</italic><sub>7</sub> &#x02264; &#x0221e; pasos/d&#x000ed;a.</p></caption><graphic xlink:href="nihms-1804923-f0007" position="float"/></fig><fig position="float" id="F8"><label>Figura 8:</label><caption><p id="P74">Figura que muestra una perturbaci&#x000f3;n estoc&#x000e1;stica no medida que influye en el comportamiento (arriba) en contraste con el logro de la meta (abajo; <italic toggle="yes">y</italic><sub>7</sub> = <italic toggle="yes">y</italic><sub>4</sub> &#x02212; <italic toggle="yes">u</italic><sub>8</sub>). La l&#x000ed;nea en rojo representa la restricci&#x000f3;n del l&#x000ed;mite inferior en el logro de la meta.</p></caption><graphic xlink:href="nihms-1804923-f0008" position="float"/></fig><table-wrap position="float" id="T1"><label>Tabla 1:</label><caption><p id="P75">Lista de se&#x000f1;ales medidas incluidas en el modelo estimado ARX y su correspondencia con las variables en el modelo TCS seg&#x000fa;n la <xref rid="F1" ref-type="fig">Figura 1</xref>. La consecuci&#x000f3;n de la meta <italic toggle="yes">&#x003be;</italic><sub>11</sub> = <italic toggle="yes">y</italic><sub>7</sub> = <italic toggle="yes">y</italic><sub>4</sub> &#x02212; <italic toggle="yes">u</italic><sub>8</sub> como una se&#x000f1;al de salida, pero puede estimarse a partir de las se&#x000f1;ales generadas (o disponibles) para el problema de identificaci&#x000f3;n del sistema.</p></caption><table frame="box" rules="all"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" valign="middle" rowspan="1" colspan="1">Nombre</th><th align="center" valign="middle" rowspan="1" colspan="1">Simbolo</th></tr></thead><tbody><tr><td colspan="2" align="center" valign="middle" rowspan="1">
<bold>Entradas de ID del sistema</bold>
</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">Contexto ambiental (Temperatura)</td><td align="center" valign="middle" rowspan="1" colspan="1">
<italic toggle="yes">&#x003be;</italic>
<sub>7</sub>
</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">Metas diarias</td><td align="center" valign="middle" rowspan="1" colspan="1">
<italic toggle="yes">u</italic>
<sub>8</sub>
</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">Puntos esperados</td><td align="center" valign="middle" rowspan="1" colspan="1">
<italic toggle="yes">u</italic>
<sub>9</sub>
</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">Puntos concedidos</td><td align="center" valign="middle" rowspan="1" colspan="1">
<italic toggle="yes">u</italic>
<sub>10</sub>
</td></tr><tr><td colspan="2" align="center" valign="middle" rowspan="1">
<bold>Salidas de ID del sistema</bold>
</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">Comportamiento</td><td align="center" valign="middle" rowspan="1" colspan="1"><italic toggle="yes">&#x003b7;</italic><sub>4</sub> = <italic toggle="yes">y</italic><sub>4</sub></td></tr></tbody></table></table-wrap></floats-group></article>
