<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><?properties manuscript?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-journal-id">101634366</journal-id><journal-id journal-id-type="pubmed-jr-id">42686</journal-id><journal-id journal-id-type="nlm-ta">ACS Photonics</journal-id><journal-id journal-id-type="iso-abbrev">ACS Photonics</journal-id><journal-title-group><journal-title>ACS photonics</journal-title></journal-title-group><issn pub-type="epub">2330-4022</issn></journal-meta><article-meta><article-id pub-id-type="pmid">36051355</article-id><article-id pub-id-type="pmc">PMC9431897</article-id><article-id pub-id-type="doi">10.1021/acsphotonics.2c00614</article-id><article-id pub-id-type="manuscript">NIHMS1823307</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Computational Proposal for Tracking Multiple Molecules in a Multifocus Confocal Setup</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Jazani</surname><given-names>Sina</given-names></name><xref rid="A1" ref-type="aff">&#x02020;</xref><xref rid="A2" ref-type="aff">&#x02021;</xref></contrib><contrib contrib-type="author"><name><surname>Xu (&#x05f90;&#x04f1f;&#x09752;)</surname><given-names>Lance W.Q.</given-names></name><xref rid="A2" ref-type="aff">&#x02021;</xref></contrib><contrib contrib-type="author"><name><surname>Sgouralis</surname><given-names>Ioannis</given-names></name><xref rid="A3" ref-type="aff">&#x000b6;</xref><xref rid="A2" ref-type="aff">&#x02021;</xref></contrib><contrib contrib-type="author"><name><surname>Shepherd</surname><given-names>Douglas P.</given-names></name><xref rid="A2" ref-type="aff">&#x02021;</xref></contrib><contrib contrib-type="author"><name><surname>Press&#x000e9;</surname><given-names>Steve</given-names></name><xref rid="A2" ref-type="aff">&#x02021;</xref><xref rid="A4" ref-type="aff">&#x000a7;</xref></contrib></contrib-group><aff id="A1"><label>&#x02020;</label> Department of Biophysics and Biophysical Chemistry, Johns Hopkins Medicine, Baltimore</aff><aff id="A2"><label>&#x02021;</label> Center for Biological Physics, Department of Physics, Arizona State University, Tempe</aff><aff id="A3"><label>&#x000b6;</label> Department of Mathematics, University of Tennessee, Knoxville</aff><aff id="A4"><label>&#x000a7;</label> School of Molecular Sciences, Arizona State University, Tempe</aff><author-notes><corresp id="CR1">
<email>spresse@asu.edu</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>30</day><month>7</month><year>2022</year></pub-date><pub-date pub-type="ppub"><day>20</day><month>7</month><year>2022</year></pub-date><pub-date pub-type="epub"><day>07</day><month>7</month><year>2022</year></pub-date><pub-date pub-type="pmc-release"><day>31</day><month>8</month><year>2022</year></pub-date><volume>9</volume><issue>7</issue><fpage>2489</fpage><lpage>2498</lpage><permissions><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under a<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC-BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract id="ABS1"><p id="P1">Tracking single molecules continues to provide new insights into the fundamental rules governing biological function. Despite continued technical advances in fluorescent and non-fluorescent labeling as well as data analysis, direct observations of trajectories and interactions of multiple molecules in dense environments remain aspirational goals. While confocal methods provide a means to deduce dynamical parameters with high temporal resolution, such as diffusion coefficients, they do so at the expense of spatial resolution. Indeed, on account of a confocal volume&#x02019;s symmetry, typically only distances from the center of the confocal spot can be deduced. Motivated by the need for true three dimensional high speed tracking in densely labeled environments, we propose a computational tool for tracking many fluorescent molecules traversing multiple, closely spaced, confocal measurement volumes providing independent observations. Various realizations of this multiple confocal volumes strategy have previously been used for long term, large area, tracking of one fluorescent molecule in three dimensions. What is more, we achieve tracking by directly using single photon arrival times to inform our likelihood and exploit Hamiltonian Monte Carlo to efficiently sample trajectories from our posterior within a Bayesian nonparametric paradigm. A nonparametric paradigm here is warranted as the number of molecules present are, themselves, <italic toggle="yes">a priori</italic> unknown. Taken together, we provide a computational framework to infer trajectories of multiple molecules at once, below the diffraction limit (the width of a confocal spot), in three dimensions at sub-millisecond or faster time scales.</p></abstract></article-meta></front><body><sec id="S1"><title>Introduction</title><p id="P2">Fluorescence confocal microscopy<sup><xref rid="R1" ref-type="bibr">1</xref>&#x02013;<xref rid="R3" ref-type="bibr">3</xref></sup> (FCM) is a non-invasive technique widely used to observe dynamics of molecules both <italic toggle="yes">in vitro</italic> and <italic toggle="yes">in vivo</italic>.<sup><xref rid="R4" ref-type="bibr">4</xref>&#x02013;<xref rid="R10" ref-type="bibr">10</xref></sup> One of the advantages of FCM is its ability to detect photons at very rapid time scales, as high as ~10 MHz, limited only by photon emission and detection in a conventional single-focus confocal microscope. Our ability to detect photons at those time scales makes it, in principle, possible to extract dynamical information on fast processes from single photon arrival times approaching data acquisition time scales. <sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> A severe drawback in determining trajectories in three dimensions, is that, for a conventional FCM setup consisting of a single confocal volume that is held stationary, we can only acquire information on the distance of molecules from the center of a single stationary confocal volume.<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> This raises the question as to whether we could learn the position of molecules, potentially many molecules simultaneously, with the high temporal resolution afforded by FCM, <italic toggle="yes">i.e.</italic>, in non-scanning mode, at a localization precision exceeding that of the size of a single confocal volume.<sup><xref rid="R2" ref-type="bibr">2</xref>,<xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R14" ref-type="bibr">14</xref></sup></p><p id="P3">It has been shown in the literature that to learn molecular positions over time, we can either track the targeted molecule by moving multi-focus confocal volumes<sup><xref rid="R15" ref-type="bibr">15</xref>&#x02013;<xref rid="R17" ref-type="bibr">17</xref></sup> or using methods such as MINFLUX.<sup><xref rid="R18" ref-type="bibr">18</xref>,<xref rid="R19" ref-type="bibr">19</xref></sup> The challenge here is that these approaches can currently track <italic toggle="yes">one</italic> molecule at a time. Consequently, the existence of <italic toggle="yes">more</italic> than one molecules within the confocal volume regions which we consider as the region of interest (ROI) leads to biased or altogether incorrect trajectory estimates. These approaches are therefore limited to low density experiments which ensure typical inter-molecular distances far exceeding the dimensions of a single confocal volume. As such, these experiments are carried out using low-density labeling in a dense molecular environment and subsequently infer behavior of the whole population from this labeled sub-population.</p><p id="P4">To overcome this limitation, critical to many applications requiring high concentrations, here we propose to analyze data from a set of stationary multi-focus confocal volumes (identical to the experimental data we analyzed for a single spot in the past <sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup>) and attempt tracking in more densely labeled environments.</p><p id="P5">As we will show, our computational approach will also estimate trajectories at the fastest possible time scale available from the raw data, i.e., from single photon arrival times. Tracking from single photon arrival times is relevant to confocal methods currently relying on photon binning at low labeling density.<sup><xref rid="R15" ref-type="bibr">15</xref>&#x02013;<xref rid="R17" ref-type="bibr">17</xref>,<xref rid="R20" ref-type="bibr">20</xref>,<xref rid="R21" ref-type="bibr">21</xref></sup> By virtue of using single photon arrival times to achieve tracking, we will be able to get away with limited light exposure to our sample to determine trajectories and, as such, can limit photo-damage to a light-sensitive sample as well as monitor processes resolved over short periods of time.<sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup></p><p id="P6">To achieve multiple molecule tracking, we must address the fundamental &#x0201c;model selection problem&#x0201d; since an unknown number of molecules within one confocal spot may be present at once. That is, depending on how many molecules we estimate to be in the volume, we obtain different trajectory and diffusion coefficient estimates. <sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> It is because the number of molecules contributing photons to the detector is unknown that we propose a nonparametric Bayesian framework.<sup><xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R22" ref-type="bibr">22</xref>,<xref rid="R23" ref-type="bibr">23</xref></sup> In doing so, we extend our previous work on single-spot detector with single photon arrival times as its output.<sup><xref rid="R13" ref-type="bibr">13</xref></sup> In doing so, we achieve multi-particle tracking with spatial resolution below the width of a single confocal spot.</p><p id="P7">We illustrate the experimental multi-focus confocal setup in <xref rid="F1" ref-type="fig">Fig. 1(a)</xref> with single-spot illumination and multi-spot detectors. The product of the excitation and detection point spread functions (PSFs) provide four neighboring confocal volumes, <xref rid="F1" ref-type="fig">Fig. 1(b)</xref>, and examples of photon arrival times, in each detection channel, are illustrated in <xref rid="F1" ref-type="fig">Fig. 1(c)</xref>.</p><p id="P8">By proposing to use single photon arrival times at each detector, just as we had for single detectors in Refs.,<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> we will break symmetry and uniquely learn three dimensional trajectories of many molecules below the conventionally-defined diffraction limit at the fastest time scale available, <italic toggle="yes">i.e.</italic>, limited only by single photon arrival times.</p><p id="P9">While we consider typical asymmetric Gaussian confocal volume shapes, as the framework and computational scheme is general, we can treat any confocal volume shape.</p></sec><sec id="S2"><title>Results and discussion</title><sec id="S3"><title>Overview</title><p id="P10">The method we propose can estimate trajectories of multiple molecules simultaneously from a multi-focus confocal microscope using the mathematics of Bayesian nonparametrics.<sup><xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R22" ref-type="bibr">22</xref>,<xref rid="R23" ref-type="bibr">23</xref></sup> Our method starts from single photon arrival times. The goal is to estimate, i.e., obtain a posterior distribution, over all unknowns. These include: the number of molecules contributing photons whose arrival times constitute our observation, the location of the molecules at each point in time (trajectories), the diffusion coefficient of the molecules, molecular brightnesses and background photon emission rates for each detector.</p></sec><sec id="S4"><title>Validation under broad parameter ranges</title><p id="P11">To validate our method&#x02019;s robustness, we generate synthetic single photon arrival times as our observation, assuming a multi-focus confocal microscopy setup, under a broad range of: (i) diffusion coefficients, <xref rid="F2" ref-type="fig">Fig. 2</xref>; (ii) numbers of labeled molecules, <xref rid="F3" ref-type="fig">Fig. 3</xref>; (iii) molecular brightnesses, <xref rid="F4" ref-type="fig">Fig. 4</xref>; and (iv) positions of detection spots, <xref rid="F5" ref-type="fig">Fig. 5</xref>.</p><p id="P12">The marginal posteriors over the molecular trajectories that we obtain across all figures are informed from the analysis of one observation trace which is the result of the combination of observation traces collected by each detector channel. In those, the breadth of the posterior (i.e., the standard deviation), which is a measure of the accuracy of our estimate, reflects the uncertainty introduced by the finiteness of the data and the inherent noise in the observation traces. To be able to evaluate the precision of our method, we compared the targeted posteriors of the molecular trajectories with ground truth trajectories. For quick reference, all results are summarized in <xref rid="SD1" ref-type="supplementary-material">SI Table. S1</xref>.</p><p id="P13">To begin, in <xref rid="F2" ref-type="fig">Fig. 2</xref>, we consider four 3D Gaussian confocal volumes of size <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">xy</italic></sub> = 0.3 <italic toggle="yes">&#x003bc;</italic>m and <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">z</italic></sub> = 1.5 <italic toggle="yes">&#x003bc;</italic>m at positions (0.3, 0.0, 0.5), (&#x02212;0.3, 0.0, 0.5), (0.0, 0.3, &#x02212;0.5) and (0.0, &#x02212;0.3, &#x02212;0.5) with respect to the point of origin (in units of <italic toggle="yes">&#x003bc;</italic>m). These confocal volume sizes are motivated from Refs.<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> and, as we can see from <xref rid="F5" ref-type="fig">Fig. 5(b)</xref>, these confocal volumes exhibit limited overlap. We generate synthetic data, just as we had generated and benchmarked with real data in Refs.<sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup> for a single-focus confocal volume, with different concentration of molecules within ROI. We consider diffusing molecules with diffusion coefficients of 0.1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup>, 1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup> and 10 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup>. These values cover a range of measured protein diffusion coefficients <italic toggle="yes">in vivo</italic>.<sup><xref rid="R24" ref-type="bibr">24</xref>,<xref rid="R25" ref-type="bibr">25</xref></sup></p><p id="P14">In all cases, for consistency, we based our analysis on just 10<sup>4</sup> photons emitted from all molecules and background and detected by all confocal volumes. Thus, the time duration of each trajectory varies based on the molecular brightness of the molecules which, in turn, depends on the molecule&#x02019;s location within the excitation and detection profile.</p><p id="P15">Beyond learning the number of molecules and their associated trajectories, from this synthetic data, we also learn diffusion coefficients, molecular brightnesses and background photon emission rates simultaneously; see <xref rid="SD1" ref-type="supplementary-material">SI Fig. S1</xref>. First off, without prior knowledge of the number of molecules, we recover a posterior over numbers of molecules sharply peaked at 1; see <xref rid="SD1" ref-type="supplementary-material">SI Fig. S1</xref>. That is, we do not put in this information by hand to obtain the results shown either in this figure or in any other. This information is critical as, without an appropriate estimate of the number of molecules giving rise to the photons, our diffusion coefficient estimates would be inaccurate; see <xref rid="F2" ref-type="fig">Fig. 2</xref> of our previous work.<sup><xref rid="R13" ref-type="bibr">13</xref></sup> And, it is fundamentally for this reason, that we must abandon the parametric Bayesian paradigm and use a nonparametric framework. Also, in <xref rid="F2" ref-type="fig">Fig. 2</xref> we can see that greater diffusion coefficients naturally lead to fewer detected photons (and thus less data) as molecules traverse the ROI. As a result, the posterior over the molecule&#x02019;s trajectory is broader. Put differently, less information or fewer photons implies less trajectory certainty and thus broader posteriors. Conversely, the slower a molecule diffuses, the more photons are collected, the sharper the posterior estimate of the molecular trajectories, <xref rid="F2" ref-type="fig">Fig. 2(a)</xref>.</p><p id="P16">In <xref rid="F3" ref-type="fig">Fig. 3</xref> we demonstrate the robustness of our method as we generate synthetic data with an increasing number of molecules in the ROI. Beyond learning the number of molecules and their associated trajectories, from this synthetic data, we also learn diffusion coefficients, molecular brightnesses and background photon emission rates simultaneously; see <xref rid="SD1" ref-type="supplementary-material">SI Fig. S3</xref>. It is worth mentioning that the posterior over the molecular trajectories is now broader when more molecules are present in the confocal volume.</p><p id="P17">That is, for two molecules as compared to one, we have greater uncertainty in both trajectories. This is because the same number of photons is now needed to learn twice as many trajectories as we had earlier. Thus the information we have available per trajectory drops. <xref rid="F3" ref-type="fig">Fig. 3</xref> also allows us to begin addressing how many photons we need to set uncertainty bounds on molecular trajectories given experimental parameters such as confocal volume dimensions, molecular diffusion coefficients and molecular brightness.</p><p id="P18">In <xref rid="F4" ref-type="fig">Fig. 4</xref>, we demonstrate the robustness of our method with respect to the molecular brightness. That depends on the photon emission rate of the molecules and the quantum yield of detectors. So, for each detector, we have different value for the molecular brightness and background photon emission rate. We provide more detail in <xref rid="SD1" ref-type="supplementary-material">SI Sec. S3.2</xref>. In particular, due to different quantum yields, we end up with different molecular brightness and background photon emission rate for each detector. Here, we evaluate the method with molecular brightnesses of 10<sup>4</sup>, 5&#x000d7;10<sup>4</sup> and 10<sup>5</sup> photons s<sup>&#x02212;1</sup> and a background photon emission rate of 10<sup>3</sup> photons s<sup>&#x02212;1</sup>; these are values in the range of those previously reported in Refs.<sup><xref rid="R24" ref-type="bibr">24</xref>,<xref rid="R25" ref-type="bibr">25</xref></sup> As expected, higher molecular brightness leads to sharper posteriors. We also learn diffusion coefficients, molecular brightnesses and background photon emission rates simultaneously; see <xref rid="SD1" ref-type="supplementary-material">SI Fig. S5</xref>.</p><p id="P19">Finally, in <xref rid="F5" ref-type="fig">Fig. 5</xref> we test the robustness of our method as we vary the configuration of the four neighboring confocal volumes. Here, we consider the case that the four confocal volumes are located symmetrically located at (&#x02212;0.01, 0.00, &#x02212;0.01), (0.01, 0.00, &#x02212;0.01), (0.00, &#x02212;0.01, 0.01) and (0.00, 0.01, 0.01) in <xref rid="F5" ref-type="fig">Fig. 5(a)</xref>, (&#x02212;0.3, 0.0, &#x02212;0.5), (0.3, 0.0, &#x02212;0.5), (0.0, &#x02212;0.3, 0.5) and (0.0, 0.3, 0.5) in <xref rid="F5" ref-type="fig">Fig. 5(b)</xref> and (&#x02212;1.0, 0.0, &#x02212;1.5), (1.0, 0.0, &#x02212;1.5), (0.0, &#x02212;1.0, 1.5) and (0.0, 1.0, 1.5) in <xref rid="F5" ref-type="fig">Fig. 5(c)</xref> with respect to the point of origin (in units of <italic toggle="yes">&#x003bc;</italic>m). Except the case that the confocal volumes overlap substantially, these distances are within the realm of what can be achieved in current experimental setups.<sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref>,<xref rid="R27" ref-type="bibr">27</xref>&#x02013;<xref rid="R30" ref-type="bibr">30</xref></sup></p><p id="P20">There exists an optimal, &#x0201c;goldilocks&#x0201d;, distance between confocal volumes that allows us to minimize trajectory uncertainty. As we see in <xref rid="F5" ref-type="fig">Fig. 5(a)</xref>, if the confocal volumes are too close, the information they provide on the molecular positions is redundant. Put differently, in the extreme case that all volumes exactly overlap, then we revert to the highly symmetric case of the single-spot (at which point we can only determine the effective distance of each molecule from the center of the single-focus confocal volume but not its 3D position).<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> Similarly, in the case that the confocal volumes are too far from each other, as in <xref rid="F5" ref-type="fig">Fig. 5(c)</xref>, each confocal volume provides independent information from other spots and the position of each molecule cannot be interpolated between confocal volumes. Thus, in this extreme limit as well, we revert to the single-focus confocal volume regime.</p><p id="P21">Although, it is clear that when confocal volumes overlap, our trajectory estimates improve, it is hard to say precisely what distance is optimal. This chiefly depends on the precise shape of the confocal volumes (we assumed a Gaussian, but this can be replaced by any analytical form), the molecular brightnesses and background photon emission rates. Beyond learning the number of molecules and their associated trajectories, from this synthetic data, we also learn diffusion coefficients, molecular brightnesses and background photon emission rates simultaneously; see <xref rid="SD1" ref-type="supplementary-material">SI Fig. S7</xref>.</p></sec></sec><sec id="S5"><title>Conclusion</title><p id="P22">We have proposed a new analysis strategy using existing stationary multi-focus confocal microscopes to track multiple molecules at once. The use of a multi-focus confocal microscope is required in order to break the symmetry of the single-focus confocal microscope<sup><xref rid="R12" ref-type="bibr">12</xref></sup> which allows for multiple molecules tracking from single photon arrival times but only up to a symmetry originating from the symmetry of the confocal volume. Multiple confocal volumes not only break symmetry but also provide non-redundant information at each detector. This allows us to have localization precision as great as ten times that of single-focus confocal volume width (see <xref rid="SD1" ref-type="supplementary-material">Figs. S2</xref>, <xref rid="SD1" ref-type="supplementary-material">S4</xref>, <xref rid="SD1" ref-type="supplementary-material">S6</xref> and <xref rid="SD1" ref-type="supplementary-material">S8</xref>); though, the magnitude of the improvement is sensitive to the diffusion coefficient, molecular brightnesses and background photon emission rates; see <xref rid="SD1" ref-type="supplementary-material">SI Figs. S1</xref>, <xref rid="SD1" ref-type="supplementary-material">S2</xref>, <xref rid="SD1" ref-type="supplementary-material">S3</xref> and <xref rid="SD1" ref-type="supplementary-material">S4</xref>.</p><p id="P23">We track many molecules simultaneously within a multi-focus confocal setup by exploiting not just temporal, but also spatial information encoded within photon arrival time traces. The ability to exploit information as it arrives one photon at a time, without binning, is particularly critical in minimizing light exposure or, in the future, to probe rapid processes resolved over rapid time scales spanning the arrival of thousands of photons.</p><p id="P24">Minimizing light exposure is not the only downstream advantage we see to our method as we envision more complex <italic toggle="yes">in vivo</italic> applications. Beyond tracking, our method retains molecular identity; for example, in <xref rid="F3" ref-type="fig">Fig. 3</xref> we see that trajectories can be discriminated even if molecular trajectories move closer to each other than the conventionally defined diffraction limit though not indefinitely. Retaining molecular identity is an advantage in resolving single molecule events unique to individual molecules with high localization precision.</p><p id="P25">To achieve such tracking, we use Beta-Bernoulli processes<sup><xref rid="R31" ref-type="bibr">31</xref>,<xref rid="R32" ref-type="bibr">32</xref></sup> and other tools from computational statistics that we recently benchmarked on a variety of single confocal volume experiments.<sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup> As we discuss in the methods section, our method can be generalized to treat alternative forms for the confocal volumes which can be distorted in real experiments or even motion models for the molecules beyond Brownian motion. Assessing, computationally, the efficiency of our posterior sampling for shapes and dynamical motion models beyond that considered, and warranted by alternative multi-focus experiments, is worthy of future study.</p><p id="P26">The method we propose here differs from existing methods such as multi-focus confocal microscopy,<sup><xref rid="R15" ref-type="bibr">15</xref>&#x02013;<xref rid="R17" ref-type="bibr">17</xref></sup> scanning confocal volume<sup><xref rid="R33" ref-type="bibr">33</xref></sup> and MINFLUX<sup><xref rid="R18" ref-type="bibr">18</xref>,<xref rid="R19" ref-type="bibr">19</xref>,<xref rid="R34" ref-type="bibr">34</xref></sup> in a number of ways. First existing methods localize and track labeled molecules one at a time and under low density conditions to avoid inaccurate tracking induced by overlapping molecular trajectories. Second, if photobleaching is avoided, they can track molecules over large distances. By contrast, our method tracks over shorter distances (as our method tracks over a fixed volume a few molecules) but is, critically, not limited to low density. What is more, we achieve high temporal resolution without photon binning.</p><p id="P27">Finally, we add that we considered four stationary confocal volumes and varied their distances; see <xref rid="F5" ref-type="fig">Fig. 5</xref>. However, as few as three confocal volumes, both axially and laterally displaced, would be sufficient to pinpoint positions in 3D albeit with greater uncertainty. While we track over limited distances, it is also conceivable, in the future, that the number of confocal volumes could possibly be increased to span broader areas.<sup><xref rid="R28" ref-type="bibr">28</xref>&#x02013;<xref rid="R30" ref-type="bibr">30</xref>,<xref rid="R35" ref-type="bibr">35</xref>&#x02013;<xref rid="R37" ref-type="bibr">37</xref></sup></p></sec><sec id="S6"><title>Method</title><sec id="S7"><title>Model overview</title><p id="P28">Here we consider an optical apparatus consisting of multi-focus confocal volumes with, for sake of concreteness, four detectors all simultaneously collecting photons; see <xref rid="F1" ref-type="fig">Fig. 1</xref>. This allows us to break the symmetry imposed by a single-focus confocal volume<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> and consequently track (fluorescing) molecules in 3D.</p><p id="P29">Based on the graphical model provided in <xref rid="F6" ref-type="fig">Fig. 6</xref>, our goal is to learn the variables: <inline-formula><mml:math id="M5" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> representing the trajectories of the molecules, <italic toggle="yes">D</italic> representing the diffusion coefficient, <inline-formula><mml:math id="M6" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> representing the molecular brightnesses and background photon emission rates and {<italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub>}<sub><italic toggle="yes">n</italic></sub> representing the indicators of molecules which tell us about the population of molecules contributing to the data. We tag the molecules with indices <italic toggle="yes">n</italic> = 1, . . . , <italic toggle="yes">N</italic> and the detectors with indices <italic toggle="yes">m</italic> = 1, . . . , <italic toggle="yes">M</italic>.</p><p id="P30">As the full joint posterior over these variables does not assume an analytic form, we must develop a numerical scheme to sample from our posterior. For this reason, we generate samples of our posterior through a Gibbs sampling scheme.<sup><xref rid="R38" ref-type="bibr">38</xref>&#x02013;<xref rid="R40" ref-type="bibr">40</xref></sup> That is, we update each one of the variables sequentially by sampling from the marginal posterior conditioned on all other variables as well as the measurements which we describe below.</p><p id="P31">In greater detail, we start from single photon arrival times. These occur at times <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> with <italic toggle="yes">k</italic> = 1, . . . , <italic toggle="yes">K</italic> and may be reported from any of <italic toggle="yes">M</italic> different detectors. For clarity, we combine the measurements from all detector channels into two observation traces: the inter-arrival times between successive photons, <inline-formula><mml:math id="M7" display="inline"><mml:mrow><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x00394;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x00394;</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; and the tags of the confocal volumes where each photon was collected, <inline-formula><mml:math id="M8" display="inline"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. According to our convention, <italic toggle="yes">&#x00394;</italic><sub><italic toggle="yes">k</italic></sub> = <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic>+1</sub> &#x02212; <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> is the inter-arrival time between two detected photons and <italic toggle="yes">s</italic><sub><italic toggle="yes">k</italic></sub> is the tag of the confocal volume which observed the photon at time <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub>.</p><p id="P32">Our goal is to use the data in <inline-formula><mml:math id="M9" display="inline"><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="M10" display="inline"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> to construct a likelihood<sup><xref rid="R40" ref-type="bibr">40</xref>,<xref rid="R41" ref-type="bibr">41</xref></sup> and, through it, a posterior probability distribution<sup><xref rid="R40" ref-type="bibr">40</xref>,<xref rid="R41" ref-type="bibr">41</xref></sup> which yields estimates of (i) the number of molecules contributing photons to the data; (ii) the trajectories of these molecules; (iii) their diffusion coefficient and brightness; and, (iv) the background photon emission rate, which are represented by the variables introduced above.</p><p id="P33">In this section, we explain the way to achieve each one of these in detail. Further details and a computational implementation can be found in the <xref rid="SD1" ref-type="supplementary-material">SI Sec. S.5</xref>. A summary of the notation, abbreviations and mathematical definitions can be found in <xref rid="SD1" ref-type="supplementary-material">SI Tables S.3</xref> and <xref rid="SD1" ref-type="supplementary-material">S.4</xref>. The graphical summary of the model explained below is shown on <xref rid="F6" ref-type="fig">Fig. 6</xref>.</p></sec><sec id="S8"><title>Model description</title><p id="P34">Since we have two independent inputs, <inline-formula><mml:math id="M11" display="inline"><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="M12" display="inline"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>, our likelihood is expressed by two independent parts: one expressing photon emission and one expressing photon detection. Respectively, these are:
<disp-formula id="FD1">
<label>(1)</label>
<mml:math id="M13" display="block"><mml:mrow><mml:msub><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="bold">Exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
<disp-formula id="FD2">
<label>(2)</label>
<mml:math id="M14" display="block"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:msub><mml:mi mathvariant="bold">t</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math>
</disp-formula>
In the above, <italic toggle="yes">&#x003bc;</italic><sub><italic toggle="yes">m,k</italic></sub> is the rate of detected photons at the <italic toggle="yes">m</italic><sup><italic toggle="yes">th</italic></sup> detector at the <italic toggle="yes">k</italic><sup><italic toggle="yes">th</italic></sup> timepoint. <xref rid="FD1" ref-type="disp-formula">Eq. (1)</xref> applies to <italic toggle="yes">k</italic> = 1, . . . , <italic toggle="yes">K</italic> &#x02212; 1 and <xref rid="FD2" ref-type="disp-formula">Eq. (2)</xref> applies to <italic toggle="yes">k</italic> = 1, . . . , <italic toggle="yes">K</italic>. The photon emission rates are given by
<disp-formula id="FD3">
<label>(3)</label>
<mml:math id="M15" display="block"><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">PSF</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</disp-formula>
and the point spread function for each of the confocal volumes, PSF<sub><italic toggle="yes">m</italic></sub> (<italic toggle="yes">x, y, z</italic>), indexed <italic toggle="yes">m</italic> is separately defined. We provide more detail in <xref rid="SD1" ref-type="supplementary-material">SI Sec. S3.2</xref>.</p><p id="P35">Here, for all the synthetic observation traces, we consider all confocal volumes as 3D Gaussians, but as we explain in the <xref rid="SD1" ref-type="supplementary-material">SI Sec. S.3.3</xref>, any functional form can be readily incorporated for the generation of analysis data</p><p id="P36">We mention that, since each confocal volume coincides with a different detector receiving photons from a different region of physical space, we represent different molecular brightnesses and background photon emission rates <inline-formula><mml:math id="M16" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M17" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> associated to each confocal volume <italic toggle="yes">m</italic>. We provide more detail in <xref rid="SD1" ref-type="supplementary-material">SI Sec. S3.2</xref>.</p><p id="P37">We assume a Brownian motion model<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> (with unknown diffusion coefficient) connecting individual positions in the trajectories, <inline-formula><mml:math id="M18" display="inline"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M19" display="inline"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M20" display="inline"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, across time by
<disp-formula id="FD4">
<label>(4)</label>
<mml:math id="M21" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="bold">Normal</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="bold">Normal</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="bold">Normal</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula>
where, <italic toggle="yes">k</italic> = 1, . . . , <italic toggle="yes">K</italic> &#x02212; 1.</p></sec><sec id="S9"><title>Model inference</title><p id="P38">The quantities that we wish to estimate are: the diffusion coefficient <italic toggle="yes">D</italic>, molecular brightnesses <inline-formula><mml:math id="M22" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and background photon emission rates <inline-formula><mml:math id="M23" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> with respect to each of the confocal volumes <italic toggle="yes">m</italic>, the population of active molecules <inline-formula><mml:math id="M24" display="inline"><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the location of the molecule <italic toggle="yes">n</italic> through time <inline-formula><mml:math id="M25" display="inline"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In this study we follow the Bayesian paradigm,<sup><xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R22" ref-type="bibr">22</xref>,<xref rid="R39" ref-type="bibr">39</xref></sup> and in particular the Bayesian nonparametric paradigm, to estimate variables of interest described above.</p><p id="P39">The variables <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub>, can take values 0 or 1 for each model molecule. Thus, each <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub> is a Bernoulli random variable. Here <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub> = 0 is associated with an inactive molecule <italic toggle="yes">n</italic> which does not contribute to the observations. If the <italic toggle="yes">n</italic><sup><italic toggle="yes">th</italic></sup> molecule contributes photons at any point during the observation trace, then it is associated with <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub> = 1 and termed active. Within the purview of nonparametrics lies our ability to introduce an arbitrarily large number of molecules, each associated with its own <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub>, and determine which of these the data warrants as &#x0201c;active&#x0201d; versus &#x0201c;inactive&#x0201d;.</p><p id="P40">Within the Bayesian paradigm, whether parametric or nonparametric, we need to define priors over all unknowns (designated by blue circles in the graphical model of <xref rid="F6" ref-type="fig">Fig. 6</xref>) and our choices over priors are detailed in the <xref rid="SD1" ref-type="supplementary-material">SI Sec. S.4.1</xref>.</p><p id="P41">Once the choices for the priors over random variables of <inline-formula><mml:math id="M26" display="inline"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are made, we form a joint posterior probability <inline-formula><mml:math id="M27" display="inline"><mml:mrow><mml:mi>&#x02119;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> encompassing all unknown variables which we may wish to determine.</p><p id="P42">On account of the complexity of our posterior with respect to variables <inline-formula><mml:math id="M28" display="inline"><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M29" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, our posterior does not assume an analytic form. For this reason, we develop a computational scheme exploiting Markov chain Monte Carlo<sup><xref rid="R38" ref-type="bibr">38</xref>,<xref rid="R39" ref-type="bibr">39</xref></sup> that can be used to generate pseudo-random samples from this posterior. Our MCMC exploits a Gibbs sampling scheme.<sup><xref rid="R38" ref-type="bibr">38</xref>&#x02013;<xref rid="R40" ref-type="bibr">40</xref></sup> Accordingly, posterior samples are generated by updating each one of the variables involved sequentially by sampling conditioned on all other variables and measurements <inline-formula><mml:math id="M30" display="inline"><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>. Conceptually, the steps involved in the generation of each posterior sample <inline-formula><mml:math id="M31" display="inline"><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M32" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are:
<list list-type="order" id="L1"><list-item><p id="P43">Sampling the trajectories <inline-formula><mml:math id="M33" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for <italic toggle="yes">n</italic> = 1, . . . , <italic toggle="yes">N</italic></p></list-item><list-item><p id="P44">Sampling the diffusion coefficient <italic toggle="yes">D</italic></p></list-item><list-item><p id="P45">Joint sampling the molecular brightnesses <inline-formula><mml:math id="M34" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and background photon emission rates <inline-formula><mml:math id="M35" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for <italic toggle="yes">m</italic> = 1, . . . , <italic toggle="yes">M</italic></p></list-item><list-item><p id="P46">Sampling the molecular loads <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub> for <italic toggle="yes">n</italic> = 1, . . . , <italic toggle="yes">N.</italic></p></list-item></list></p><p id="P47">To achieve step (1) without approximations on the forms of <xref rid="FD1" ref-type="disp-formula">Eqs. (1)</xref> and <xref rid="FD2" ref-type="disp-formula">(2)</xref>, we use a Hamiltonian Monte Carlo (HMC) sampling scheme.<sup><xref rid="R39" ref-type="bibr">39</xref>,<xref rid="R43" ref-type="bibr">43</xref>&#x02013;<xref rid="R45" ref-type="bibr">45</xref></sup> This is by contrast to our previous work,<sup><xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R13" ref-type="bibr">13</xref></sup> where we exploited approximate Kalman filters <sup><xref rid="R46" ref-type="bibr">46</xref>&#x02013;<xref rid="R52" ref-type="bibr">52</xref></sup> to infer the molecular positions. Step (2) can be achieved analytically by virtue of the conjugacy of the prior to the marginal likelihood, steps (3) is achieved by a brute-force Metropolis scheme, and step (4) can be achieved by direct sampling. More details can be found in <xref rid="SD1" ref-type="supplementary-material">SI S.5</xref>.</p><p id="P48">A full detailed mathematical formulation and computational implementation of our proposed model, based on the multi-focus confocal microscope, is explained in the <xref rid="SD1" ref-type="supplementary-material">SI Sec. S.4</xref> and <xref rid="SD1" ref-type="supplementary-material">S.5</xref>.</p></sec></sec><sec sec-type="supplementary-material" id="SM1"><title>Supplementary Material</title><supplementary-material id="SD1" position="float" content-type="local-data"><label>ACS2_SI</label><media xlink:href="NIHMS1823307-supplement-ACS2_SI.pdf" id="d64e2454" position="anchor"/></supplementary-material></sec></body><back><ack id="S10"><title>Acknowledgement</title><p id="P49">S.P. thank NIH NIGMS (R01GM130745) for supporting Ioannis Sgouralis (early efforts in nonparametrics and tracking) and NIH NIGMS (R01GM134426) for supporting Sina Jazani (single photon efforts).</p></ack><fn-group><fn id="FN1"><p id="P50">Supporting Information Available</p><p id="P51">The following files are available free of charge.
<list list-type="bullet" id="L2"><list-item><p id="P52">Filename: <xref rid="SD1" ref-type="supplementary-material">Supporting information</xref></p></list-item><list-item><p id="P53">Filename: Source code and GUI</p></list-item></list></p></fn></fn-group><ref-list><title>References</title><ref id="R1"><label>(1)</label><mixed-citation publication-type="journal"><name><surname>Spring</surname><given-names>K</given-names></name>; <name><surname>Davidson</surname><given-names>M</given-names></name>
<article-title>Introduction to fluorescence microscopy</article-title>. <source>Nikon Microscopy U</source>. <year>2008</year>.</mixed-citation></ref><ref id="R2"><label>(2)</label><mixed-citation publication-type="book"><name><surname>Stockert</surname><given-names>JC</given-names></name>; <name><surname>Blazquez-Castro</surname><given-names>A</given-names></name>
<source>Fluorescence Microscopy in Life Sciences</source>; <publisher-name>Bentham Science Publishers</publisher-name>, <year>2017</year>.</mixed-citation></ref><ref id="R3"><label>(3)</label><mixed-citation publication-type="book"><name><surname>Art</surname><given-names>J</given-names></name>
<source>Handbook of biological confocal microscopy</source>; <publisher-name>Springer</publisher-name>, <year>2006</year>; pp <fpage>251</fpage>&#x02013;<lpage>264</lpage>.</mixed-citation></ref><ref id="R4"><label>(4)</label><mixed-citation publication-type="journal"><name><surname>Magde</surname><given-names>D</given-names></name>; <name><surname>Elson</surname><given-names>EL</given-names></name>; <name><surname>Webb</surname><given-names>WW</given-names></name>
<article-title>Fluorescence correlation spectroscopy. II. An experimental realization</article-title>. <source>Biopolymers</source>
<year>1974</year>, <volume>13</volume>, <fpage>29</fpage>&#x02013;<lpage>61</lpage>.<pub-id pub-id-type="pmid">4818131</pub-id></mixed-citation></ref><ref id="R5"><label>(5)</label><mixed-citation publication-type="journal"><name><surname>Wohland</surname><given-names>T</given-names></name>; <name><surname>Rigler</surname><given-names>R</given-names></name>; <name><surname>Vogel</surname><given-names>H</given-names></name>
<article-title>The standard deviation in fluorescence correlation spectroscopy</article-title>. <source>Biophysical Journal</source>
<year>2001</year>, <volume>80</volume>, <fpage>2987</fpage>&#x02013;<lpage>2999</lpage>.<pub-id pub-id-type="pmid">11371471</pub-id></mixed-citation></ref><ref id="R6"><label>(6)</label><mixed-citation publication-type="journal"><name><surname>Ruprecht</surname><given-names>V</given-names></name>; <name><surname>Wieser</surname><given-names>S</given-names></name>; <name><surname>Marguet</surname><given-names>D</given-names></name>; <name><surname>Sch&#x000fc;tz</surname><given-names>GJ</given-names></name>
<article-title>Spot variation fluorescence correlation spectroscopy allows for superresolution chronoscopy of confinement times in membranes</article-title>. <source>Biophysical Journal</source>
<year>2011</year>, <volume>100</volume>, <fpage>2839</fpage>&#x02013;<lpage>2845</lpage>.<pub-id pub-id-type="pmid">21641330</pub-id></mixed-citation></ref><ref id="R7"><label>(7)</label><mixed-citation publication-type="journal"><name><surname>Hassler</surname><given-names>K</given-names></name>; <name><surname>Leutenegger</surname><given-names>M</given-names></name>; <name><surname>Rigler</surname><given-names>P</given-names></name>; <name><surname>Rao</surname><given-names>R</given-names></name>; <name><surname>Rigler</surname><given-names>R</given-names></name>; <name><surname>G&#x000f6;sch</surname><given-names>M</given-names></name>; <name><surname>Lasser</surname><given-names>T</given-names></name>
<article-title>Total internal reflection fluorescence correlation spectroscopy (TIR-FCS) with low background and high count-rate per molecule</article-title>. <source>Optics Express</source>
<year>2005</year>, <volume>13</volume>, <fpage>7415</fpage>&#x02013;<lpage>7423</lpage>.<pub-id pub-id-type="pmid">19498766</pub-id></mixed-citation></ref><ref id="R8"><label>(8)</label><mixed-citation publication-type="journal"><name><surname>Berland</surname><given-names>KM</given-names></name>; <name><surname>So</surname><given-names>P</given-names></name>; <name><surname>Gratton</surname><given-names>E</given-names></name>
<article-title>Two-photon fluorescence correlation spectroscopy: method and application to the intracellular environment</article-title>. <source>Biophysical Journal</source>
<year>1995</year>, <volume>68</volume>, <fpage>694</fpage>&#x02013;<lpage>701</lpage>.<pub-id pub-id-type="pmid">7696520</pub-id></mixed-citation></ref><ref id="R9"><label>(9)</label><mixed-citation publication-type="journal"><name><surname>Rigler</surname><given-names>R</given-names></name>; <name><surname>Mets</surname><given-names>&#x000dc;</given-names></name>; <name><surname>Widengren</surname><given-names>J</given-names></name>; <name><surname>Kask</surname><given-names>P</given-names></name>
<article-title>Fluorescence correlation spectroscopy with high count rate and low background: analysis of translational diffusion</article-title>. <source>European Biophysics Journal</source>
<year>1993</year>, <volume>22</volume>, <fpage>169</fpage>&#x02013;<lpage>175</lpage>.</mixed-citation></ref><ref id="R10"><label>(10)</label><mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>A</given-names></name>; <name><surname>Tsekouras</surname><given-names>K</given-names></name>; <name><surname>Calderon</surname><given-names>C</given-names></name>; <name><surname>Bustamante</surname><given-names>C</given-names></name>; <name><surname>Press&#x000e9;</surname><given-names>S</given-names></name>
<article-title>Unraveling the thousand word picture: an introduction to super-resolution data analysis</article-title>. <source>Chemical Reviews</source>
<year>2017</year>, <volume>117</volume>, <fpage>7276</fpage>&#x02013;<lpage>7330</lpage>.<pub-id pub-id-type="pmid">28414216</pub-id></mixed-citation></ref><ref id="R11"><label>(11)</label><mixed-citation publication-type="journal"><name><surname>Jazani</surname><given-names>S</given-names></name>; <name><surname>Sgouralis</surname><given-names>I</given-names></name>; <name><surname>Shafraz</surname><given-names>OM</given-names></name>; <name><surname>Levitus</surname><given-names>M</given-names></name>; <name><surname>Sivasankar</surname><given-names>S</given-names></name>; <name><surname>Press&#x000e9;</surname><given-names>S</given-names></name>
<article-title>An alternative framework for fluorescence correlation spectroscopy</article-title>. <source>Nature Communications</source>
<year>2019</year>, <volume>10</volume>, <fpage>1</fpage>&#x02013;<lpage>10</lpage>.</mixed-citation></ref><ref id="R12"><label>(12)</label><mixed-citation publication-type="journal"><name><surname>Jazani</surname><given-names>S</given-names></name>; <name><surname>Sgouralis</surname><given-names>I</given-names></name>; <name><surname>Press&#x000e9;</surname><given-names>S</given-names></name>
<article-title>A method for single molecule tracking using a conventional single-focus confocal setup</article-title>. <source>The Journal of Chemical Physics</source>
<year>2019</year>, <volume>150</volume>, <fpage>123320</fpage>.</mixed-citation></ref><ref id="R13"><label>(13)</label><mixed-citation publication-type="journal"><name><surname>Tavakoli</surname><given-names>M</given-names></name>; <name><surname>Jazani</surname><given-names>S</given-names></name>; <name><surname>Sgouralis</surname><given-names>I</given-names></name>; <name><surname>Shafraz</surname><given-names>OM</given-names></name>; <name><surname>Sivasankar</surname><given-names>S</given-names></name>; <name><surname>Donaphon</surname><given-names>B</given-names></name>; <name><surname>Levitus</surname><given-names>M</given-names></name>; <name><surname>Press&#x000e9;</surname><given-names>S</given-names></name>
<article-title>Pitching Single-Focus Confocal Data Analysis One Photon at a Time with Bayesian Nonparametrics</article-title>. <source>Physical Review X</source>
<year>2020</year>, <volume>10</volume>, <fpage>011021</fpage>.<pub-id pub-id-type="pmid">34540355</pub-id></mixed-citation></ref><ref id="R14"><label>(14)</label><mixed-citation publication-type="book"><name><surname>Rost</surname><given-names>FW</given-names></name>
<source>Fluorescence microscopy</source>; <publisher-name>Cambridge University Press</publisher-name>, <year>1992</year>; Vol. <volume>2</volume>.</mixed-citation></ref><ref id="R15"><label>(15)</label><mixed-citation publication-type="journal"><name><surname>Wells</surname><given-names>NP</given-names></name>; <name><surname>Lessard</surname><given-names>GA</given-names></name>; <name><surname>Werner</surname><given-names>JH</given-names></name>
<article-title>Confocal, three-dimensional tracking of individual quantum dots in high-background environments</article-title>. <source>Analytical Chemistry</source>
<year>2008</year>, <volume>80</volume>, <fpage>9830</fpage>&#x02013;<lpage>9834</lpage>.<pub-id pub-id-type="pmid">19072277</pub-id></mixed-citation></ref><ref id="R16"><label>(16)</label><mixed-citation publication-type="journal"><name><surname>Wells</surname><given-names>NP</given-names></name>; <name><surname>Lessard</surname><given-names>GA</given-names></name>; <name><surname>Goodwin</surname><given-names>PM</given-names></name>; <name><surname>Phipps</surname><given-names>ME</given-names></name>; <name><surname>Cutler</surname><given-names>PJ</given-names></name>; <name><surname>Lidke</surname><given-names>DS</given-names></name>; <name><surname>Wilson</surname><given-names>BS</given-names></name>; <name><surname>Werner</surname><given-names>JH</given-names></name>
<article-title>Time-resolved three-dimensional molecular tracking in live cells</article-title>. <source>Nano Letters</source>
<year>2010</year>, <volume>10</volume>, <fpage>4732</fpage>&#x02013;<lpage>4737</lpage>.<pub-id pub-id-type="pmid">20957984</pub-id></mixed-citation></ref><ref id="R17"><label>(17)</label><mixed-citation publication-type="journal"><name><surname>Perillo</surname><given-names>EP</given-names></name>; <name><surname>Liu</surname><given-names>Y-L</given-names></name>; <name><surname>Huynh</surname><given-names>K</given-names></name>; <name><surname>Liu</surname><given-names>C</given-names></name>; <name><surname>Chou</surname><given-names>C-K</given-names></name>; <name><surname>Hung</surname><given-names>M-C</given-names></name>; <name><surname>Yeh</surname><given-names>H-C</given-names></name>; <name><surname>Dunn</surname><given-names>AK</given-names></name>
<article-title>Deep and high-resolution three-dimensional tracking of single particles using nonlinear and multiplexed illumination</article-title>. <source>Nature Communications</source>
<year>2015</year>, <volume>6</volume>, <fpage>7874</fpage>.</mixed-citation></ref><ref id="R18"><label>(18)</label><mixed-citation publication-type="journal"><name><surname>Eilers</surname><given-names>Y</given-names></name>; <name><surname>Ta</surname><given-names>H</given-names></name>; <name><surname>Gwosch</surname><given-names>KC</given-names></name>; <name><surname>Balzarotti</surname><given-names>F</given-names></name>; <name><surname>Hell</surname><given-names>SW</given-names></name>
<article-title>MINFLUX monitors rapid molecular jumps with superior spatiotemporal resolution</article-title>. <source>Proceedings of the National Academy of Sciences</source>
<year>2018</year>, <volume>115</volume>, <fpage>6117</fpage>&#x02013;<lpage>6122</lpage>.</mixed-citation></ref><ref id="R19"><label>(19)</label><mixed-citation publication-type="journal"><name><surname>Balzarotti</surname><given-names>F</given-names></name>; <name><surname>Eilers</surname><given-names>Y</given-names></name>; <name><surname>Gwosch</surname><given-names>KC</given-names></name>; <name><surname>Gynn&#x000e5;</surname><given-names>AH</given-names></name>; <name><surname>Westphal</surname><given-names>V</given-names></name>; <name><surname>Stefani</surname><given-names>FD</given-names></name>; <name><surname>Elf</surname><given-names>J</given-names></name>; <name><surname>Hell</surname><given-names>SW</given-names></name>
<article-title>Nanometer resolution imaging and tracking of fluorescent molecules with minimal photon fluxes</article-title>. <source>Science</source>
<year>2017</year>, <volume>355</volume>, <fpage>606</fpage>&#x02013;<lpage>612</lpage>.<pub-id pub-id-type="pmid">28008086</pub-id></mixed-citation></ref><ref id="R20"><label>(20)</label><mixed-citation publication-type="journal"><name><surname>Sahl</surname><given-names>SJ</given-names></name>; <name><surname>Leutenegger</surname><given-names>M</given-names></name>; <name><surname>Hilbert</surname><given-names>M</given-names></name>; <name><surname>Hell</surname><given-names>SW</given-names></name>; <name><surname>Eggeling</surname><given-names>C</given-names></name>
<article-title>Fast molecular tracking maps nanoscale dynamics of plasma membrane lipids</article-title>. <source>Proceedings of the National Academy of Sciences</source>
<year>2010</year>, <volume>107</volume>, <fpage>6829</fpage>&#x02013;<lpage>6834</lpage>.</mixed-citation></ref><ref id="R21"><label>(21)</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>N</given-names></name>; <name><surname>Zhao</surname><given-names>R</given-names></name>; <name><surname>Sun</surname><given-names>Y</given-names></name>; <name><surname>Ye</surname><given-names>Z</given-names></name>; <name><surname>He</surname><given-names>K</given-names></name>; <name><surname>Fang</surname><given-names>X</given-names></name>
<article-title>Single-molecule imaging and tracking of molecular dynamics in living cells</article-title>. <source>National Science Review</source>
<year>2017</year>, <volume>4</volume>, <fpage>739</fpage>&#x02013;<lpage>760</lpage>.</mixed-citation></ref><ref id="R22"><label>(22)</label><mixed-citation publication-type="book"><name><surname>Tavakoli</surname><given-names>M</given-names></name>; <name><surname>Taylor</surname><given-names>JN</given-names></name>; <name><surname>Li</surname><given-names>C-B</given-names></name>; <name><surname>Komatsuzaki</surname><given-names>T</given-names></name>; <name><surname>Press&#x000e9;</surname><given-names>S</given-names></name>
<source>Advances in Chemical Physics</source>; <publisher-name>John Wiley &#x00026; Sons</publisher-name>, <year>2017</year>; Chapter <volume>4</volume>, pp <fpage>205</fpage>&#x02013;<lpage>305</lpage>.</mixed-citation></ref><ref id="R23"><label>(23)</label><mixed-citation publication-type="journal"><name><surname>Hines</surname><given-names>KE</given-names></name>
<article-title>A primer on Bayesian inference for biophysical systems</article-title>. <source>Biophysical Journal</source>
<year>2015</year>, <volume>108</volume>, <fpage>2103</fpage>&#x02013;<lpage>2113</lpage>.<pub-id pub-id-type="pmid">25954869</pub-id></mixed-citation></ref><ref id="R24"><label>(24)</label><mixed-citation publication-type="journal"><name><surname>Elowitz</surname><given-names>MB</given-names></name>; <name><surname>Surette</surname><given-names>MG</given-names></name>; <name><surname>Wolf</surname><given-names>P-E</given-names></name>; <name><surname>Stock</surname><given-names>JB</given-names></name>; <name><surname>Leibler</surname><given-names>S</given-names></name>
<article-title>Protein Mobility in the Cytoplasm of Escherichia coli</article-title>. <source>Journal of Bacteriology</source>
<year>1999</year>, <volume>181</volume>, <fpage>197</fpage>&#x02013;<lpage>203</lpage>.<pub-id pub-id-type="pmid">9864330</pub-id></mixed-citation></ref><ref id="R25"><label>(25)</label><mixed-citation publication-type="journal"><name><surname>Konopka</surname><given-names>MC</given-names></name>; <name><surname>Shkel</surname><given-names>IA</given-names></name>; <name><surname>Cayley</surname><given-names>S</given-names></name>; <name><surname>Record</surname><given-names>MT</given-names></name>; <name><surname>Weisshaar</surname><given-names>JC</given-names></name>
<article-title>Crowding and confinement effects on protein diffusion in vivo</article-title>. <source>Journal of Bacteriology</source>
<year>2006</year>, <volume>188</volume>, <fpage>6115</fpage>&#x02013;<lpage>6123</lpage>.<pub-id pub-id-type="pmid">16923878</pub-id></mixed-citation></ref><ref id="R26"><label>(26)</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>Y</given-names></name>; <name><surname>M&#x000fc;ller</surname><given-names>JD</given-names></name>; <name><surname>Ruan</surname><given-names>Q</given-names></name>; <name><surname>Gratton</surname><given-names>E</given-names></name>
<article-title>Molecular brightness characterization of EGFP in vivo by fluorescence fluctuation spectroscopy</article-title>. <source>Biophysical Journal</source>
<year>2002</year>, <volume>82</volume>, <fpage>133</fpage>&#x02013;<lpage>144</lpage>.<pub-id pub-id-type="pmid">11751302</pub-id></mixed-citation></ref><ref id="R27"><label>(27)</label><mixed-citation publication-type="journal"><name><surname>Lessard</surname><given-names>GA</given-names></name>; <name><surname>Goodwin</surname><given-names>PM</given-names></name>; <name><surname>Werner</surname><given-names>JH</given-names></name>
<article-title>Three-dimensional tracking of individual quantum dots</article-title>. <source>Applied Physics Letters</source>
<year>2007</year>, <volume>91</volume>, <fpage>224106</fpage>.</mixed-citation></ref><ref id="R28"><label>(28)</label><mixed-citation publication-type="journal"><name><surname>Poland</surname><given-names>SP</given-names></name>; <name><surname>Krstaji&#x00107;</surname><given-names>N</given-names></name>; <name><surname>Monypenny</surname><given-names>J</given-names></name>; <name><surname>Coelho</surname><given-names>S</given-names></name>; <name><surname>Tyndall</surname><given-names>D</given-names></name>; <name><surname>Walker</surname><given-names>RJ</given-names></name>; <name><surname>Devauges</surname><given-names>V</given-names></name>; <name><surname>Richardson</surname><given-names>J</given-names></name>; <name><surname>Dutton</surname><given-names>N</given-names></name>; <name><surname>Barber</surname><given-names>P</given-names></name>; <name><surname>Li</surname><given-names>DD-U</given-names></name>; <name><surname>Suhling</surname><given-names>K</given-names></name>; <name><surname>Ng</surname><given-names>T</given-names></name>; <name><surname>Henderson</surname><given-names>RK</given-names></name>; <name><surname>Ameer-Beg</surname><given-names>SM</given-names></name>
<article-title>A high speed multifocal multiphoton fluorescence lifetime imaging microscope for live-cell FRET imaging</article-title>. <source>Biomedical optics express</source>
<year>2015</year>, <volume>6</volume>, <fpage>277</fpage>&#x02013;<lpage>296</lpage>.<pub-id pub-id-type="pmid">25780724</pub-id></mixed-citation></ref><ref id="R29"><label>(29)</label><mixed-citation publication-type="journal"><name><surname>Lubin</surname><given-names>G</given-names></name>; <name><surname>Tenne</surname><given-names>R</given-names></name>; <name><surname>Antolovic</surname><given-names>IM</given-names></name>; <name><surname>Charbon</surname><given-names>E</given-names></name>; <name><surname>Bruschini</surname><given-names>C</given-names></name>; <name><surname>Oron</surname><given-names>D</given-names></name>
<article-title>Quantum correlation measurement with single photon avalanche diode arrays</article-title>. <source>Optics Express</source>
<year>2019</year>, <volume>27</volume>, <fpage>32863</fpage>&#x02013;<lpage>32882</lpage>.<pub-id pub-id-type="pmid">31878363</pub-id></mixed-citation></ref><ref id="R30"><label>(30)</label><mixed-citation publication-type="journal"><name><surname>Badon</surname><given-names>A</given-names></name>; <name><surname>Bensussen</surname><given-names>S</given-names></name>; <name><surname>Gritton</surname><given-names>HJ</given-names></name>; <name><surname>Awal</surname><given-names>MR</given-names></name>; <name><surname>Gabel</surname><given-names>CV</given-names></name>; <name><surname>Han</surname><given-names>X</given-names></name>; <name><surname>Mertz</surname><given-names>J</given-names></name>
<article-title>Video-rate large-scale imaging with Multi-Z confocal microscopy</article-title>. <source>Optica</source>
<year>2019</year>, <volume>6</volume>, <fpage>389</fpage>&#x02013;<lpage>395</lpage>.<pub-id pub-id-type="pmid">34504902</pub-id></mixed-citation></ref><ref id="R31"><label>(31)</label><mixed-citation publication-type="journal"><name><surname>Fox</surname><given-names>E</given-names></name>; <name><surname>Jordan</surname><given-names>MI</given-names></name>; <name><surname>Sudderth</surname><given-names>EB</given-names></name>; <name><surname>Willsky</surname><given-names>AS</given-names></name>
<article-title>Sharing features among dynamical systems with beta processes</article-title>. <source>Advances in Neural Information Processing Systems</source>. <year>2009</year>; pp <fpage>549</fpage>&#x02013;<lpage>557</lpage>.</mixed-citation></ref><ref id="R32"><label>(32)</label><mixed-citation publication-type="journal"><name><surname>Thibaux</surname><given-names>R</given-names></name>; <name><surname>Jordan</surname><given-names>MI</given-names></name>
<article-title>Hierarchical beta processes and the Indian buffet process</article-title>. <source>Artificial Intelligence and Statistics</source>. <year>2007</year>; pp <fpage>564</fpage>&#x02013;<lpage>571</lpage>.</mixed-citation></ref><ref id="R33"><label>(33)</label><mixed-citation publication-type="journal"><name><surname>Lanzan&#x000f2;</surname><given-names>L</given-names></name>; <name><surname>Gratton</surname><given-names>E</given-names></name>
<article-title>Orbital single particle tracking on a commercial confocal microscope using piezoelectric stage feedback</article-title>. <source>Methods and applications in fluorescence</source>
<year>2014</year>, <volume>2</volume>, <fpage>024010</fpage>.</mixed-citation></ref><ref id="R34"><label>(34)</label><mixed-citation publication-type="journal"><name><surname>Gwosch</surname><given-names>KC</given-names></name>; <name><surname>Pape</surname><given-names>JK</given-names></name>; <name><surname>Balzarotti</surname><given-names>F</given-names></name>; <name><surname>Hoess</surname><given-names>P</given-names></name>; <name><surname>Ellenberg</surname><given-names>J</given-names></name>; <name><surname>Ries</surname><given-names>J</given-names></name>; <name><surname>Hell</surname><given-names>SW</given-names></name>
<article-title>MINFLUX nanoscopy delivers 3D multicolor nanometer resolution in cells</article-title>. <source>Nature Methods</source>
<year>2020</year>, <fpage>1</fpage>&#x02013;<lpage>8</lpage>.<pub-id pub-id-type="pmid">31907477</pub-id></mixed-citation></ref><ref id="R35"><label>(35)</label><mixed-citation publication-type="journal"><name><surname>Castello</surname><given-names>M</given-names></name>; <name><surname>Tortarolo</surname><given-names>G</given-names></name>; <name><surname>Buttafava</surname><given-names>M</given-names></name>; <name><surname>Deguchi</surname><given-names>T</given-names></name>; <name><surname>Villa</surname><given-names>F</given-names></name>; <name><surname>Koho</surname><given-names>S</given-names></name>; <name><surname>Pesce</surname><given-names>L</given-names></name>; <name><surname>Oneto</surname><given-names>M</given-names></name>; <name><surname>Pelicci</surname><given-names>S</given-names></name>; <name><surname>Lanzan&#x000f3;</surname><given-names>L</given-names></name>; <name><surname>Bianchini</surname><given-names>P</given-names></name>; <name><surname>Sheppard</surname><given-names>CJR</given-names></name>; <name><surname>Diaspro</surname><given-names>A</given-names></name>; <name><surname>Tosi</surname><given-names>A</given-names></name>; <name><surname>Vicidomini</surname><given-names>G</given-names></name>
<article-title>A robust and versatile platform for image scanning microscopy enabling super-resolution FLIM</article-title>. <source>Nature methods</source>
<year>2019</year>, <volume>16</volume>, <fpage>175</fpage>&#x02013;<lpage>178</lpage>.<pub-id pub-id-type="pmid">30643212</pub-id></mixed-citation></ref><ref id="R36"><label>(36)</label><mixed-citation publication-type="journal"><name><surname>Colyer</surname><given-names>RA</given-names></name>; <name><surname>Scalia</surname><given-names>G</given-names></name>; <name><surname>Rech</surname><given-names>I</given-names></name>; <name><surname>Gulinatti</surname><given-names>A</given-names></name>; <name><surname>Ghioni</surname><given-names>M</given-names></name>; <name><surname>Cova</surname><given-names>S</given-names></name>; <name><surname>Weiss</surname><given-names>S</given-names></name>; <name><surname>Michalet</surname><given-names>X</given-names></name>
<article-title>High-throughput FCS using an LCOS spatial light modulator and an 8&#x000d7;1 SPAD array</article-title>. <source>Biomedical Optics Express</source>
<year>2010</year>, <volume>1</volume>, <fpage>1408</fpage>&#x02013;<lpage>1431</lpage>.<pub-id pub-id-type="pmid">21258559</pub-id></mixed-citation></ref><ref id="R37"><label>(37)</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>DU</given-names></name>; <name><surname>Tyndall</surname><given-names>D</given-names></name>; <name><surname>Walker</surname><given-names>R</given-names></name>; <name><surname>Richardson</surname><given-names>JA</given-names></name>; <name><surname>Henderson</surname><given-names>RK</given-names></name>; <name><surname>Arlt</surname><given-names>J</given-names></name>; <name><surname>Stoppa</surname><given-names>D</given-names></name>; <name><surname>Charbon</surname><given-names>E</given-names></name>
<article-title>Video-rate fluorescence lifetime imaging camera with CMOS single-photon avalanche diode arrays and high-speed imaging algorithm</article-title>. <source>Journal of Biomedical Optics</source>
<year>2011</year>, <volume>16</volume>, <fpage>096012</fpage>.<pub-id pub-id-type="pmid">21950926</pub-id></mixed-citation></ref><ref id="R38"><label>(38)</label><mixed-citation publication-type="book"><name><surname>Robert</surname><given-names>C</given-names></name>; <name><surname>Casella</surname><given-names>G</given-names></name>
<source>Introducing Monte Carlo Methods with R</source>; <publisher-name>Springer Science &#x00026; Business Media</publisher-name>, <year>2009</year>.</mixed-citation></ref><ref id="R39"><label>(39)</label><mixed-citation publication-type="book"><name><surname>Gelman</surname><given-names>A</given-names></name>; <name><surname>Carlin</surname><given-names>JB</given-names></name>; <name><surname>Stern</surname><given-names>HS</given-names></name>; <name><surname>Dunson</surname><given-names>DB</given-names></name>; <name><surname>Vehtari</surname><given-names>A</given-names></name>; <name><surname>Rubin</surname><given-names>DB</given-names></name>
<source>Bayesian data analysis</source>; <publisher-name>CRC press</publisher-name>
<publisher-loc>Boca Raton, FL</publisher-loc>, <year>2014</year>; Vol. <volume>2</volume>.</mixed-citation></ref><ref id="R40"><label>(40)</label><mixed-citation publication-type="journal"><name><surname>Von Toussaint</surname><given-names>U</given-names></name>
<article-title>Bayesian inference in physics</article-title>. <source>Reviews of Modern Physics</source>
<year>2011</year>, <volume>83</volume>, <fpage>943</fpage>.</mixed-citation></ref><ref id="R41"><label>(41)</label><mixed-citation publication-type="book"><name><surname>Sivia</surname><given-names>D</given-names></name>; <name><surname>Skilling</surname><given-names>J</given-names></name>
<source>Data analysis: a Bayesian tutorial</source>; <publisher-name>OUP Oxford</publisher-name>, <year>2006</year>.</mixed-citation></ref><ref id="R42"><label>(42)</label><mixed-citation publication-type="book"><name><surname>Bishop</surname><given-names>CM</given-names></name>
<source>Pattern recognition and machine learning</source>; <publisher-name>springer</publisher-name>, <year>2006</year>.</mixed-citation></ref><ref id="R43"><label>(43)</label><mixed-citation publication-type="other"><name><surname>Neal</surname><given-names>RM</given-names></name>
<source>MCMC using Hamiltonian dynamics</source>. <year>2012</year>.</mixed-citation></ref><ref id="R44"><label>(44)</label><mixed-citation publication-type="other"><name><surname>Betancourt</surname><given-names>M</given-names></name>
<source>A Conceptual Introduction to Hamiltonian Monte Carlo</source>. <year>2017</year>.</mixed-citation></ref><ref id="R45"><label>(45)</label><mixed-citation publication-type="journal"><name><surname>Hoffman</surname><given-names>MD</given-names></name>; <name><surname>Gelman</surname><given-names>A</given-names></name>
<article-title>The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo</article-title>. <source>Journal of Machine Learning Research</source>
<year>2014</year>, <volume>15</volume>, <fpage>1593</fpage>&#x02013;<lpage>1623</lpage>.</mixed-citation></ref><ref id="R46"><label>(46)</label><mixed-citation publication-type="journal"><name><surname>Byron</surname><given-names>MY</given-names></name>; <name><surname>Shenoy</surname><given-names>KV</given-names></name>; <name><surname>Sahani</surname><given-names>M</given-names></name>
<article-title>Derivation of extended Kalman filtering and smoothing equations</article-title>. <source>Technical Report, Stanford University</source>
<year>2004</year>, <volume>19</volume>, <fpage>25</fpage>.</mixed-citation></ref><ref id="R47"><label>(47)</label><mixed-citation publication-type="confproc"><name><surname>Wan</surname><given-names>EA</given-names></name>; <name><surname>Van Der Merwe</surname><given-names>R</given-names></name>
<source>The unscented Kalman filter for nonlinear estimation</source>. <conf-name>Adaptive Systems for Signal Processing, Communications, and Control Symposium 2000. AS-SPCC</conf-name>. <publisher-name>The IEEE</publisher-name>
<year>2000</year>. <comment>2000</comment>; pp <fpage>153</fpage>&#x02013;<lpage>158</lpage>.</mixed-citation></ref><ref id="R48"><label>(48)</label><mixed-citation publication-type="journal"><name><surname>Menegaz</surname><given-names>HM</given-names></name>; <name><surname>Ishihara</surname><given-names>JY</given-names></name>; <name><surname>Borges</surname><given-names>GA</given-names></name>; <name><surname>Vargas</surname><given-names>AN</given-names></name>
<article-title>A systematization of the unscented Kalman filter theory</article-title>. <source>IEEE Transactions on automatic control</source>
<year>2015</year>, <volume>60</volume>, <fpage>2583</fpage>&#x02013;<lpage>2598</lpage>.</mixed-citation></ref><ref id="R49"><label>(49)</label><mixed-citation publication-type="book"><name><surname>Stoer</surname><given-names>J</given-names></name>; <name><surname>Bulirsch</surname><given-names>R</given-names></name>
<source>Introduction to numerical analysis</source>; <publisher-name>Springer Science &#x00026; Business Media</publisher-name>, <year>2013</year>; Vol. <volume>12</volume>.</mixed-citation></ref><ref id="R50"><label>(50)</label><mixed-citation publication-type="journal"><name><surname>Kalman</surname><given-names>RE</given-names></name>
<article-title>A new approach to linear filtering and prediction problems</article-title>. <source>Journal of Basic Engineering</source>
<year>1960</year>, <volume>82</volume>, <fpage>35</fpage>&#x02013;<lpage>45</lpage>.</mixed-citation></ref><ref id="R51"><label>(51)</label><mixed-citation publication-type="journal"><name><surname>Kalman</surname><given-names>RE</given-names></name>; <name><surname>Bucy</surname><given-names>RS</given-names></name>
<article-title>New results in linear filtering and prediction theory</article-title>. <source>Journal of Basic Engineering</source>
<year>1961</year>, <volume>83</volume>, <fpage>95</fpage>&#x02013;<lpage>108</lpage>.</mixed-citation></ref><ref id="R52"><label>(52)</label><mixed-citation publication-type="book"><name><surname>Sorenson</surname><given-names>HW</given-names></name>
<source>Advances in Control Systems</source>; <publisher-name>Elsevier</publisher-name>, <year>1966</year>; Vol. <volume>3</volume>; pp <fpage>219</fpage>&#x02013;<lpage>292</lpage>.</mixed-citation></ref></ref-list></back><floats-group><fig position="float" id="F1"><label>Figure 1:</label><caption><title>Illustration of a simultaneous multi-focus confocal setup.</title><p id="P54"><bold>(a)</bold> Schematic of a single-spot illumination and multi-spot detector forming a microscope with multi-focus confocal volumes. <bold>(b)</bold> Idealized PSF shapes in the object space (originating from the overlap of the excitation and detection PSFs). The confocal volumes are shown as ellipsoids for visual purposes. <bold>(c)</bold> Single photon arrival time traces, illustrating photon detection times over the course of an experiment by the four axially and laterally shifted detection volumes. Each panel corresponds to a different channel.</p></caption><graphic xlink:href="nihms-1823307-f0001" position="float"/></fig><fig position="float" id="F2"><label>Figure 2:</label><caption><title>Effect of the diffusion coefficient on the precision of the trajectory estimate.</title><p id="P55"><bold>(a-c)</bold> Trajectory estimate of a single freely diffusive molecule with diffusion coefficient of 0.1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup>, 1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup> and 10 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup> in 3D, respectively. These values cover the range of protein and nucleic acid diffusion constants <italic toggle="yes">in vivo</italic>.<sup><xref rid="R24" ref-type="bibr">24</xref>,<xref rid="R25" ref-type="bibr">25</xref></sup> As we note in the text, we remark on the growing error bars as the diffusion coefficient increases. Note that for clarity y-axis on a-c have different bounds. In all three cases, we used molecular brightnesses of 5 &#x000d7; 10<sup>4</sup> photons s<sup>&#x02212;1</sup> and background photon emission rates of 10<sup>3</sup> photons s<sup>&#x02212;1</sup>. These values are identical to those drawn from real data in Refs.,<sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup> have been used to generate the trajectories. The photon detection times from all detectors, are shown with blue lines and the total number of detected photons for all cases is 10<sup>4</sup>. The gray areas represent the width of a single 3D gaussian confocal volume which for X, Y and Z coordinates are equal to 2 &#x000d7; <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">x</italic></sub>, 2 &#x000d7; <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">y</italic></sub> and 2 &#x000d7; <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">z</italic></sub>, respectively.</p></caption><graphic xlink:href="nihms-1823307-f0002" position="float"/></fig><fig position="float" id="F3"><label>Figure 3:</label><caption><title>Effect of the number of molecules contributing photons on the precision of the trajectory estimate.</title><p id="P56"><bold>(a-c)</bold> Trajectory estimates for one, two and three freely diffusing molecules, respectively. All three cases were generated with a diffusion coefficient of 1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup>, molecular brightness of 5 &#x000d7; 10<sup>4</sup> photons s<sup>&#x02212;1</sup> and background photon emission rate of 10<sup>3</sup> photons s<sup>&#x02212;1</sup>. The photon detection times are shown with blue lines and the total number of detected photons for all cases is 10<sup>4</sup>. For approximate confocal volumes of ~ 2.11 fL, dividing the number of molecules by the volume, these coincide with approximate concentrations of 0.79, 1.57 and 2.36 nM.</p></caption><graphic xlink:href="nihms-1823307-f0003" position="float"/></fig><fig position="float" id="F4"><label>Figure 4:</label><caption><title>Effect of the molecular brightness on the precision of the trajectory estimate.</title><p id="P57"><bold>(a-c)</bold> Trajectory estimates for a single freely diffusive molecule with molecular brightness of 10<sup>4</sup> photons s<sup>&#x02212;1</sup>, 5 &#x000d7; 10<sup>4</sup> photons s<sup>&#x02212;1</sup> and 10<sup>5</sup> photons s<sup>&#x02212;1</sup> for all detection spots, respectively. These values are motivated by Refs. <sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R13" ref-type="bibr">13</xref>,<xref rid="R26" ref-type="bibr">26</xref></sup> For all three cases, diffusion coefficient of 1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup> and the background photon emission rate of 10<sup>3</sup> photons s<sup>&#x02212;1</sup> have been used to generate the trajectories. The photon detection times are shown with blue lines and the total number of detected photons for all cases is 10<sup>4</sup>.</p></caption><graphic xlink:href="nihms-1823307-f0004" position="float"/></fig><fig position="float" id="F5"><label>Figure 5:</label><caption><title>Effect of the configuration of the confocal volumes on the precision of the trajectory estimate.</title><p id="P58"><bold>(a)</bold> Trajectory estimates of a freely diffusive molecule where the confocal volumes overlap substantially and are located at (&#x02212;0.01, 0.00, &#x02212;0.01), (0.01, 0.00, &#x02212;0.01), (0.00, &#x02212;0.01, 0.01) and (0.00, 0.01, 0.01). (<bold>b</bold>) Trajectory estimates of a freely diffusive molecule with confocal volumes minimally overlapping and located at (&#x02212;0.3, 0.0, &#x02212;0.5), (0.3, 0.0, &#x02212;0.5), (0.0, &#x02212;0.3, 0.5) and (0.0, 0.3, 0.5). (<bold>c</bold>) Trajectory estimates of a freely diffusive molecule with confocal volumes are far away and located at (&#x02212;1.0, 0.0, &#x02212;1.5), (1.0, 0.0, &#x02212;1.5), (0.0, &#x02212;1.0, 1.5) and (0.0, 1.0, 1.5). For all three cases, coordinates are with respect to the point of origin (in units of <italic toggle="yes">&#x003bc;</italic>m) and the diffusion coefficient of 1 <italic toggle="yes">&#x003bc;</italic>m<sup>2</sup>s<sup>&#x02212;1</sup>, molecular brightness of 5 &#x000d7; 10<sup>4</sup> photons s<sup>&#x02212;1</sup> and background photon emission rate of 10<sup>3</sup> photons s<sup>&#x02212;1</sup> have been used to generate the trajectories. The photon detection times are shown with blue lines and the total number of detected photons for all cases is 10<sup>4</sup>.</p></caption><graphic xlink:href="nihms-1823307-f0005" position="float"/></fig><fig position="float" id="F6"><label>Figure 6:</label><caption><title>Graphical representation of the model for multiple molecules and many confocal volumes.</title><p id="P59">Molecules diffuse over the course of the experiment. Here, (<italic toggle="yes">x</italic><sub><italic toggle="yes">n,k</italic></sub><italic toggle="yes">, y</italic><sub><italic toggle="yes">n,k</italic></sub><italic toggle="yes">, z</italic><sub><italic toggle="yes">n,k</italic></sub>) denotes the location of molecule <italic toggle="yes">n</italic> at time <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> and the photon arrivals over all confocal volumes are marked by <italic toggle="yes">k</italic> = 1, 2, . . . , <italic toggle="yes">K</italic>. During the experiment, <italic toggle="yes">&#x00394;</italic><sub><italic toggle="yes">k</italic></sub>, is the inter-arrival time which is equal to the time difference between successive photon detection times <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> and <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic>+1</sub>. The <italic toggle="yes">k</italic><sup>th</sup> photon can be detected by any of the detectors <italic toggle="yes">s</italic><sub><italic toggle="yes">k</italic></sub> = 1, . . . , <italic toggle="yes">M</italic>. In full generality, as each confocal volume may have different properties, we index the molecular brightness and the background photon emission rate of each as follows: <inline-formula><mml:math id="M1" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>mol</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M2" display="inline"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext>back</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for <italic toggle="yes">m</italic> = 1, . . . , <italic toggle="yes">M</italic>. The diffusion coefficient <italic toggle="yes">D</italic> dictates the molecular dynamics and determines future molecular locations which, in turn, determine the location of the molecule within the illuminated volume, influences the photon emission rates and, ultimately, the photon arrival times. In order to learn the number of existing molecules we introduce auxiliary variables <italic toggle="yes">b</italic><sub><italic toggle="yes">n</italic></sub> termed &#x0201c;loads&#x0201d;. Following machine learning convention, <sup><xref rid="R42" ref-type="bibr">42</xref></sup> the circle surrounding measurement, <inline-formula><mml:math id="M3" display="inline"><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="M4" display="inline"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>, random variables are shaded in grey while model variables requiring prior probability distributions are shaded in blue.</p></caption><graphic xlink:href="nihms-1823307-f0006" position="float"/></fig></floats-group></article>
